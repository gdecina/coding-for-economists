Traceback (most recent call last):
  File "/Users/arthurturrell/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/jupyter_cache/executors/utils.py", line 51, in single_nb_execution
    executenb(
  File "/Users/arthurturrell/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/Users/arthurturrell/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/Users/arthurturrell/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/Users/arthurturrell/opt/anaconda3/envs/codeforecon/lib/python3.8/asyncio/base_events.py", line 616, in run_until_complete
    return future.result()
  File "/Users/arthurturrell/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/Users/arthurturrell/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/Users/arthurturrell/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
stata_df.replace({-99: pd.NA})
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mRecursionError[0m                            Traceback (most recent call last)
Input [0;32mIn [17][0m, in [0;36m<cell line: 1>[0;34m()[0m
[0;32m----> 1[0m [43mstata_df[49m[38;5;241;43m.[39;49m[43mreplace[49m[43m([49m[43m{[49m[38;5;241;43m-[39;49m[38;5;241;43m99[39;49m[43m:[49m[43m [49m[43mpd[49m[38;5;241;43m.[39;49m[43mNA[49m[43m}[49m[43m)[49m

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/util/_decorators.py:331[0m, in [0;36mdeprecate_nonkeyword_arguments.<locals>.decorate.<locals>.wrapper[0;34m(*args, **kwargs)[0m
[1;32m    325[0m [38;5;28;01mif[39;00m [38;5;28mlen[39m(args) [38;5;241m>[39m num_allow_args:
[1;32m    326[0m     warnings[38;5;241m.[39mwarn(
[1;32m    327[0m         msg[38;5;241m.[39mformat(arguments[38;5;241m=[39m_format_argument_list(allow_args)),
[1;32m    328[0m         [38;5;167;01mFutureWarning[39;00m,
[1;32m    329[0m         stacklevel[38;5;241m=[39mfind_stack_level(),
[1;32m    330[0m     )
[0;32m--> 331[0m [38;5;28;01mreturn[39;00m [43mfunc[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/frame.py:5717[0m, in [0;36mDataFrame.replace[0;34m(self, to_replace, value, inplace, limit, regex, method)[0m
[1;32m   5704[0m [38;5;129m@deprecate_nonkeyword_arguments[39m(
[1;32m   5705[0m     version[38;5;241m=[39m[38;5;28;01mNone[39;00m, allowed_args[38;5;241m=[39m[[38;5;124m"[39m[38;5;124mself[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mto_replace[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mvalue[39m[38;5;124m"[39m]
[1;32m   5706[0m )
[0;32m   (...)[0m
[1;32m   5715[0m     method: Literal[[38;5;124m"[39m[38;5;124mpad[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mffill[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mbfill[39m[38;5;124m"[39m] [38;5;241m|[39m lib[38;5;241m.[39mNoDefault [38;5;241m=[39m lib[38;5;241m.[39mno_default,
[1;32m   5716[0m ) [38;5;241m-[39m[38;5;241m>[39m DataFrame [38;5;241m|[39m [38;5;28;01mNone[39;00m:
[0;32m-> 5717[0m     [38;5;28;01mreturn[39;00m [38;5;28;43msuper[39;49m[43m([49m[43m)[49m[38;5;241;43m.[39;49m[43mreplace[49m[43m([49m
[1;32m   5718[0m [43m        [49m[43mto_replace[49m[38;5;241;43m=[39;49m[43mto_replace[49m[43m,[49m
[1;32m   5719[0m [43m        [49m[43mvalue[49m[38;5;241;43m=[39;49m[43mvalue[49m[43m,[49m
[1;32m   5720[0m [43m        [49m[43minplace[49m[38;5;241;43m=[39;49m[43minplace[49m[43m,[49m
[1;32m   5721[0m [43m        [49m[43mlimit[49m[38;5;241;43m=[39;49m[43mlimit[49m[43m,[49m
[1;32m   5722[0m [43m        [49m[43mregex[49m[38;5;241;43m=[39;49m[43mregex[49m[43m,[49m
[1;32m   5723[0m [43m        [49m[43mmethod[49m[38;5;241;43m=[39;49m[43mmethod[49m[43m,[49m
[1;32m   5724[0m [43m    [49m[43m)[49m

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/util/_decorators.py:331[0m, in [0;36mdeprecate_nonkeyword_arguments.<locals>.decorate.<locals>.wrapper[0;34m(*args, **kwargs)[0m
[1;32m    325[0m [38;5;28;01mif[39;00m [38;5;28mlen[39m(args) [38;5;241m>[39m num_allow_args:
[1;32m    326[0m     warnings[38;5;241m.[39mwarn(
[1;32m    327[0m         msg[38;5;241m.[39mformat(arguments[38;5;241m=[39m_format_argument_list(allow_args)),
[1;32m    328[0m         [38;5;167;01mFutureWarning[39;00m,
[1;32m    329[0m         stacklevel[38;5;241m=[39mfind_stack_level(),
[1;32m    330[0m     )
[0;32m--> 331[0m [38;5;28;01mreturn[39;00m [43mfunc[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/generic.py:7188[0m, in [0;36mNDFrame.replace[0;34m(self, to_replace, value, inplace, limit, regex, method)[0m
[1;32m   7185[0m     [38;5;28;01melse[39;00m:
[1;32m   7186[0m         to_replace, value [38;5;241m=[39m keys, values
[0;32m-> 7188[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mreplace[49m[43m([49m
[1;32m   7189[0m [43m        [49m[43mto_replace[49m[43m,[49m[43m [49m[43mvalue[49m[43m,[49m[43m [49m[43minplace[49m[38;5;241;43m=[39;49m[43minplace[49m[43m,[49m[43m [49m[43mlimit[49m[38;5;241;43m=[39;49m[43mlimit[49m[43m,[49m[43m [49m[43mregex[49m[38;5;241;43m=[39;49m[43mregex[49m
[1;32m   7190[0m [43m    [49m[43m)[49m
[1;32m   7191[0m [38;5;28;01melse[39;00m:
[1;32m   7192[0m 
[1;32m   7193[0m     [38;5;66;03m# need a non-zero len on all axes[39;00m
[1;32m   7194[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m [38;5;28mself[39m[38;5;241m.[39msize:

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/util/_decorators.py:331[0m, in [0;36mdeprecate_nonkeyword_arguments.<locals>.decorate.<locals>.wrapper[0;34m(*args, **kwargs)[0m
[1;32m    325[0m [38;5;28;01mif[39;00m [38;5;28mlen[39m(args) [38;5;241m>[39m num_allow_args:
[1;32m    326[0m     warnings[38;5;241m.[39mwarn(
[1;32m    327[0m         msg[38;5;241m.[39mformat(arguments[38;5;241m=[39m_format_argument_list(allow_args)),
[1;32m    328[0m         [38;5;167;01mFutureWarning[39;00m,
[1;32m    329[0m         stacklevel[38;5;241m=[39mfind_stack_level(),
[1;32m    330[0m     )
[0;32m--> 331[0m [38;5;28;01mreturn[39;00m [43mfunc[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/frame.py:5717[0m, in [0;36mDataFrame.replace[0;34m(self, to_replace, value, inplace, limit, regex, method)[0m
[1;32m   5704[0m [38;5;129m@deprecate_nonkeyword_arguments[39m(
[1;32m   5705[0m     version[38;5;241m=[39m[38;5;28;01mNone[39;00m, allowed_args[38;5;241m=[39m[[38;5;124m"[39m[38;5;124mself[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mto_replace[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mvalue[39m[38;5;124m"[39m]
[1;32m   5706[0m )
[0;32m   (...)[0m
[1;32m   5715[0m     method: Literal[[38;5;124m"[39m[38;5;124mpad[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mffill[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mbfill[39m[38;5;124m"[39m] [38;5;241m|[39m lib[38;5;241m.[39mNoDefault [38;5;241m=[39m lib[38;5;241m.[39mno_default,
[1;32m   5716[0m ) [38;5;241m-[39m[38;5;241m>[39m DataFrame [38;5;241m|[39m [38;5;28;01mNone[39;00m:
[0;32m-> 5717[0m     [38;5;28;01mreturn[39;00m [38;5;28;43msuper[39;49m[43m([49m[43m)[49m[38;5;241;43m.[39;49m[43mreplace[49m[43m([49m
[1;32m   5718[0m [43m        [49m[43mto_replace[49m[38;5;241;43m=[39;49m[43mto_replace[49m[43m,[49m
[1;32m   5719[0m [43m        [49m[43mvalue[49m[38;5;241;43m=[39;49m[43mvalue[49m[43m,[49m
[1;32m   5720[0m [43m        [49m[43minplace[49m[38;5;241;43m=[39;49m[43minplace[49m[43m,[49m
[1;32m   5721[0m [43m        [49m[43mlimit[49m[38;5;241;43m=[39;49m[43mlimit[49m[43m,[49m
[1;32m   5722[0m [43m        [49m[43mregex[49m[38;5;241;43m=[39;49m[43mregex[49m[43m,[49m
[1;32m   5723[0m [43m        [49m[43mmethod[49m[38;5;241;43m=[39;49m[43mmethod[49m[43m,[49m
[1;32m   5724[0m [43m    [49m[43m)[49m

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/util/_decorators.py:331[0m, in [0;36mdeprecate_nonkeyword_arguments.<locals>.decorate.<locals>.wrapper[0;34m(*args, **kwargs)[0m
[1;32m    325[0m [38;5;28;01mif[39;00m [38;5;28mlen[39m(args) [38;5;241m>[39m num_allow_args:
[1;32m    326[0m     warnings[38;5;241m.[39mwarn(
[1;32m    327[0m         msg[38;5;241m.[39mformat(arguments[38;5;241m=[39m_format_argument_list(allow_args)),
[1;32m    328[0m         [38;5;167;01mFutureWarning[39;00m,
[1;32m    329[0m         stacklevel[38;5;241m=[39mfind_stack_level(),
[1;32m    330[0m     )
[0;32m--> 331[0m [38;5;28;01mreturn[39;00m [43mfunc[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/generic.py:7237[0m, in [0;36mNDFrame.replace[0;34m(self, to_replace, value, inplace, limit, regex, method)[0m
[1;32m   7232[0m     [38;5;28;01mif[39;00m [38;5;28mlen[39m(to_replace) [38;5;241m!=[39m [38;5;28mlen[39m(value):
[1;32m   7233[0m         [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m(
[1;32m   7234[0m             [38;5;124mf[39m[38;5;124m"[39m[38;5;124mReplacement lists must match in length. [39m[38;5;124m"[39m
[1;32m   7235[0m             [38;5;124mf[39m[38;5;124m"[39m[38;5;124mExpecting [39m[38;5;132;01m{[39;00m[38;5;28mlen[39m(to_replace)[38;5;132;01m}[39;00m[38;5;124m got [39m[38;5;132;01m{[39;00m[38;5;28mlen[39m(value)[38;5;132;01m}[39;00m[38;5;124m [39m[38;5;124m"[39m
[1;32m   7236[0m         )
[0;32m-> 7237[0m     new_data [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_mgr[49m[38;5;241;43m.[39;49m[43mreplace_list[49m[43m([49m
[1;32m   7238[0m [43m        [49m[43msrc_list[49m[38;5;241;43m=[39;49m[43mto_replace[49m[43m,[49m
[1;32m   7239[0m [43m        [49m[43mdest_list[49m[38;5;241;43m=[39;49m[43mvalue[49m[43m,[49m
[1;32m   7240[0m [43m        [49m[43minplace[49m[38;5;241;43m=[39;49m[43minplace[49m[43m,[49m
[1;32m   7241[0m [43m        [49m[43mregex[49m[38;5;241;43m=[39;49m[43mregex[49m[43m,[49m
[1;32m   7242[0m [43m    [49m[43m)[49m
[1;32m   7244[0m [38;5;28;01melif[39;00m to_replace [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[1;32m   7245[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m (
[1;32m   7246[0m         is_re_compilable(regex)
[1;32m   7247[0m         [38;5;129;01mor[39;00m is_list_like(regex)
[1;32m   7248[0m         [38;5;129;01mor[39;00m is_dict_like(regex)
[1;32m   7249[0m     ):

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/internals/managers.py:484[0m, in [0;36mBaseBlockManager.replace_list[0;34m(self, src_list, dest_list, inplace, regex)[0m
[1;32m    481[0m [38;5;124;03m"""do a list replace"""[39;00m
[1;32m    482[0m inplace [38;5;241m=[39m validate_bool_kwarg(inplace, [38;5;124m"[39m[38;5;124minplace[39m[38;5;124m"[39m)
[0;32m--> 484[0m bm [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mapply[49m[43m([49m
[1;32m    485[0m [43m    [49m[38;5;124;43m"[39;49m[38;5;124;43mreplace_list[39;49m[38;5;124;43m"[39;49m[43m,[49m
[1;32m    486[0m [43m    [49m[43msrc_list[49m[38;5;241;43m=[39;49m[43msrc_list[49m[43m,[49m
[1;32m    487[0m [43m    [49m[43mdest_list[49m[38;5;241;43m=[39;49m[43mdest_list[49m[43m,[49m
[1;32m    488[0m [43m    [49m[43minplace[49m[38;5;241;43m=[39;49m[43minplace[49m[43m,[49m
[1;32m    489[0m [43m    [49m[43mregex[49m[38;5;241;43m=[39;49m[43mregex[49m[43m,[49m
[1;32m    490[0m [43m[49m[43m)[49m
[1;32m    491[0m bm[38;5;241m.[39m_consolidate_inplace()
[1;32m    492[0m [38;5;28;01mreturn[39;00m bm

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/internals/managers.py:347[0m, in [0;36mBaseBlockManager.apply[0;34m(self, f, align_keys, ignore_failures, **kwargs)[0m
[1;32m    345[0m         applied [38;5;241m=[39m b[38;5;241m.[39mapply(f, [38;5;241m*[39m[38;5;241m*[39mkwargs)
[1;32m    346[0m     [38;5;28;01melse[39;00m:
[0;32m--> 347[0m         applied [38;5;241m=[39m [38;5;28;43mgetattr[39;49m[43m([49m[43mb[49m[43m,[49m[43m [49m[43mf[49m[43m)[49m[43m([49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m    348[0m [38;5;28;01mexcept[39;00m ([38;5;167;01mTypeError[39;00m, [38;5;167;01mNotImplementedError[39;00m):
[1;32m    349[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m ignore_failures:

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/internals/blocks.py:735[0m, in [0;36mBlock.replace_list[0;34m(self, src_list, dest_list, inplace, regex)[0m
[1;32m    730[0m     m [38;5;241m=[39m mib[blk_num : blk_num [38;5;241m+[39m [38;5;241m1[39m]
[1;32m    732[0m [38;5;66;03m# error: Argument "mask" to "_replace_coerce" of "Block" has[39;00m
[1;32m    733[0m [38;5;66;03m# incompatible type "Union[ExtensionArray, ndarray[Any, Any], bool]";[39;00m
[1;32m    734[0m [38;5;66;03m# expected "ndarray[Any, dtype[bool_]]"[39;00m
[0;32m--> 735[0m result [38;5;241m=[39m [43mblk[49m[38;5;241;43m.[39;49m[43m_replace_coerce[49m[43m([49m
[1;32m    736[0m [43m    [49m[43mto_replace[49m[38;5;241;43m=[39;49m[43msrc[49m[43m,[49m
[1;32m    737[0m [43m    [49m[43mvalue[49m[38;5;241;43m=[39;49m[43mdest[49m[43m,[49m
[1;32m    738[0m [43m    [49m[43mmask[49m[38;5;241;43m=[39;49m[43mm[49m[43m,[49m[43m  [49m[38;5;66;43;03m# type: ignore[arg-type][39;49;00m
[1;32m    739[0m [43m    [49m[43minplace[49m[38;5;241;43m=[39;49m[43minplace[49m[43m,[49m
[1;32m    740[0m [43m    [49m[43mregex[49m[38;5;241;43m=[39;49m[43mregex[49m[43m,[49m
[1;32m    741[0m [43m[49m[43m)[49m
[1;32m    742[0m [38;5;28;01mif[39;00m convert [38;5;129;01mand[39;00m blk[38;5;241m.[39mis_object [38;5;129;01mand[39;00m [38;5;129;01mnot[39;00m [38;5;28mall[39m(x [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m [38;5;28;01mfor[39;00m x [38;5;129;01min[39;00m dest_list):
[1;32m    743[0m     [38;5;66;03m# GH#44498 avoid unwanted cast-back[39;00m
[1;32m    744[0m     result [38;5;241m=[39m extend_blocks(
[1;32m    745[0m         [b[38;5;241m.[39mconvert(numeric[38;5;241m=[39m[38;5;28;01mFalse[39;00m, copy[38;5;241m=[39m[38;5;28;01mTrue[39;00m) [38;5;28;01mfor[39;00m b [38;5;129;01min[39;00m result]
[1;32m    746[0m     )

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/internals/blocks.py:799[0m, in [0;36mBlock._replace_coerce[0;34m(self, to_replace, value, mask, inplace, regex)[0m
[1;32m    797[0m         [38;5;28;01mreturn[39;00m [nb]
[1;32m    798[0m     [38;5;28;01mreturn[39;00m [[38;5;28mself[39m] [38;5;28;01mif[39;00m inplace [38;5;28;01melse[39;00m [[38;5;28mself[39m[38;5;241m.[39mcopy()]
[0;32m--> 799[0m [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mreplace[49m[43m([49m
[1;32m    800[0m [43m    [49m[43mto_replace[49m[38;5;241;43m=[39;49m[43mto_replace[49m[43m,[49m[43m [49m[43mvalue[49m[38;5;241;43m=[39;49m[43mvalue[49m[43m,[49m[43m [49m[43minplace[49m[38;5;241;43m=[39;49m[43minplace[49m[43m,[49m[43m [49m[43mmask[49m[38;5;241;43m=[39;49m[43mmask[49m
[1;32m    801[0m [43m[49m[43m)[49m

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/internals/blocks.py:624[0m, in [0;36mBlock.replace[0;34m(self, to_replace, value, inplace, mask)[0m
[1;32m    621[0m blocks [38;5;241m=[39m []
[1;32m    622[0m [38;5;28;01mfor[39;00m i, nb [38;5;129;01min[39;00m [38;5;28menumerate[39m([38;5;28mself[39m[38;5;241m.[39m_split()):
[1;32m    623[0m     blocks[38;5;241m.[39mextend(
[0;32m--> 624[0m         [38;5;28;43mtype[39;49m[43m([49m[38;5;28;43mself[39;49m[43m)[49m[38;5;241;43m.[39;49m[43mreplace[49m[43m([49m
[1;32m    625[0m [43m            [49m[43mnb[49m[43m,[49m
[1;32m    626[0m [43m            [49m[43mto_replace[49m[38;5;241;43m=[39;49m[43mto_replace[49m[43m,[49m
[1;32m    627[0m [43m            [49m[43mvalue[49m[38;5;241;43m=[39;49m[43mvalue[49m[43m,[49m
[1;32m    628[0m [43m            [49m[43minplace[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m
[1;32m    629[0m [43m            [49m[43mmask[49m[38;5;241;43m=[39;49m[43mmask[49m[43m[[49m[43mi[49m[43m [49m[43m:[49m[43m [49m[43mi[49m[43m [49m[38;5;241;43m+[39;49m[43m [49m[38;5;241;43m1[39;49m[43m][49m[43m,[49m
[1;32m    630[0m [43m        [49m[43m)[49m
[1;32m    631[0m     )
[1;32m    632[0m [38;5;28;01mreturn[39;00m blocks

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/internals/blocks.py:612[0m, in [0;36mBlock.replace[0;34m(self, to_replace, value, inplace, mask)[0m
[1;32m    610[0m [38;5;28;01melif[39;00m [38;5;28mself[39m[38;5;241m.[39mndim [38;5;241m==[39m [38;5;241m1[39m [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39mshape[[38;5;241m0[39m] [38;5;241m==[39m [38;5;241m1[39m:
[1;32m    611[0m     blk [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mcoerce_to_target_dtype(value)
[0;32m--> 612[0m     [38;5;28;01mreturn[39;00m [43mblk[49m[38;5;241;43m.[39;49m[43mreplace[49m[43m([49m
[1;32m    613[0m [43m        [49m[43mto_replace[49m[38;5;241;43m=[39;49m[43mto_replace[49m[43m,[49m
[1;32m    614[0m [43m        [49m[43mvalue[49m[38;5;241;43m=[39;49m[43mvalue[49m[43m,[49m
[1;32m    615[0m [43m        [49m[43minplace[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m
[1;32m    616[0m [43m        [49m[43mmask[49m[38;5;241;43m=[39;49m[43mmask[49m[43m,[49m
[1;32m    617[0m [43m    [49m[43m)[49m
[1;32m    619[0m [38;5;28;01melse[39;00m:
[1;32m    620[0m     [38;5;66;03m# split so that we only upcast where necessary[39;00m
[1;32m    621[0m     blocks [38;5;241m=[39m []

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/internals/blocks.py:612[0m, in [0;36mBlock.replace[0;34m(self, to_replace, value, inplace, mask)[0m
[1;32m    610[0m [38;5;28;01melif[39;00m [38;5;28mself[39m[38;5;241m.[39mndim [38;5;241m==[39m [38;5;241m1[39m [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39mshape[[38;5;241m0[39m] [38;5;241m==[39m [38;5;241m1[39m:
[1;32m    611[0m     blk [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mcoerce_to_target_dtype(value)
[0;32m--> 612[0m     [38;5;28;01mreturn[39;00m [43mblk[49m[38;5;241;43m.[39;49m[43mreplace[49m[43m([49m
[1;32m    613[0m [43m        [49m[43mto_replace[49m[38;5;241;43m=[39;49m[43mto_replace[49m[43m,[49m
[1;32m    614[0m [43m        [49m[43mvalue[49m[38;5;241;43m=[39;49m[43mvalue[49m[43m,[49m
[1;32m    615[0m [43m        [49m[43minplace[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m
[1;32m    616[0m [43m        [49m[43mmask[49m[38;5;241;43m=[39;49m[43mmask[49m[43m,[49m
[1;32m    617[0m [43m    [49m[43m)[49m
[1;32m    619[0m [38;5;28;01melse[39;00m:
[1;32m    620[0m     [38;5;66;03m# split so that we only upcast where necessary[39;00m
[1;32m    621[0m     blocks [38;5;241m=[39m []

    [0;31m[... skipping similar frames: Block.replace at line 612 (2945 times)][0m

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/internals/blocks.py:612[0m, in [0;36mBlock.replace[0;34m(self, to_replace, value, inplace, mask)[0m
[1;32m    610[0m [38;5;28;01melif[39;00m [38;5;28mself[39m[38;5;241m.[39mndim [38;5;241m==[39m [38;5;241m1[39m [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39mshape[[38;5;241m0[39m] [38;5;241m==[39m [38;5;241m1[39m:
[1;32m    611[0m     blk [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mcoerce_to_target_dtype(value)
[0;32m--> 612[0m     [38;5;28;01mreturn[39;00m [43mblk[49m[38;5;241;43m.[39;49m[43mreplace[49m[43m([49m
[1;32m    613[0m [43m        [49m[43mto_replace[49m[38;5;241;43m=[39;49m[43mto_replace[49m[43m,[49m
[1;32m    614[0m [43m        [49m[43mvalue[49m[38;5;241;43m=[39;49m[43mvalue[49m[43m,[49m
[1;32m    615[0m [43m        [49m[43minplace[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m
[1;32m    616[0m [43m        [49m[43mmask[49m[38;5;241;43m=[39;49m[43mmask[49m[43m,[49m
[1;32m    617[0m [43m    [49m[43m)[49m
[1;32m    619[0m [38;5;28;01melse[39;00m:
[1;32m    620[0m     [38;5;66;03m# split so that we only upcast where necessary[39;00m
[1;32m    621[0m     blocks [38;5;241m=[39m []

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/internals/blocks.py:611[0m, in [0;36mBlock.replace[0;34m(self, to_replace, value, inplace, mask)[0m
[1;32m    608[0m     [38;5;28;01mreturn[39;00m blocks
[1;32m    610[0m [38;5;28;01melif[39;00m [38;5;28mself[39m[38;5;241m.[39mndim [38;5;241m==[39m [38;5;241m1[39m [38;5;129;01mor[39;00m [38;5;28mself[39m[38;5;241m.[39mshape[[38;5;241m0[39m] [38;5;241m==[39m [38;5;241m1[39m:
[0;32m--> 611[0m     blk [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mcoerce_to_target_dtype[49m[43m([49m[43mvalue[49m[43m)[49m
[1;32m    612[0m     [38;5;28;01mreturn[39;00m blk[38;5;241m.[39mreplace(
[1;32m    613[0m         to_replace[38;5;241m=[39mto_replace,
[1;32m    614[0m         value[38;5;241m=[39mvalue,
[1;32m    615[0m         inplace[38;5;241m=[39m[38;5;28;01mTrue[39;00m,
[1;32m    616[0m         mask[38;5;241m=[39mmask,
[1;32m    617[0m     )
[1;32m    619[0m [38;5;28;01melse[39;00m:
[1;32m    620[0m     [38;5;66;03m# split so that we only upcast where necessary[39;00m

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/internals/blocks.py:450[0m, in [0;36mBlock.coerce_to_target_dtype[0;34m(self, other)[0m
[1;32m    441[0m [38;5;124;03m"""[39;00m
[1;32m    442[0m [38;5;124;03mcoerce the current block to a dtype compat for other[39;00m
[1;32m    443[0m [38;5;124;03mwe will return a block, possibly object, and not raise[39;00m
[0;32m   (...)[0m
[1;32m    446[0m [38;5;124;03mand will receive the same block[39;00m
[1;32m    447[0m [38;5;124;03m"""[39;00m
[1;32m    448[0m new_dtype [38;5;241m=[39m find_result_type([38;5;28mself[39m[38;5;241m.[39mvalues, other)
[0;32m--> 450[0m [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mastype[49m[43m([49m[43mnew_dtype[49m[43m,[49m[43m [49m[43mcopy[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m[43m)[49m

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/internals/blocks.py:526[0m, in [0;36mBlock.astype[0;34m(self, dtype, copy, errors)[0m
[1;32m    508[0m [38;5;124;03m"""[39;00m
[1;32m    509[0m [38;5;124;03mCoerce to the new dtype.[39;00m
[1;32m    510[0m 
[0;32m   (...)[0m
[1;32m    522[0m [38;5;124;03mBlock[39;00m
[1;32m    523[0m [38;5;124;03m"""[39;00m
[1;32m    524[0m values [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mvalues
[0;32m--> 526[0m new_values [38;5;241m=[39m [43mastype_array_safe[49m[43m([49m[43mvalues[49m[43m,[49m[43m [49m[43mdtype[49m[43m,[49m[43m [49m[43mcopy[49m[38;5;241;43m=[39;49m[43mcopy[49m[43m,[49m[43m [49m[43merrors[49m[38;5;241;43m=[39;49m[43merrors[49m[43m)[49m
[1;32m    528[0m new_values [38;5;241m=[39m maybe_coerce_values(new_values)
[1;32m    529[0m newb [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mmake_block(new_values)

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/dtypes/astype.py:299[0m, in [0;36mastype_array_safe[0;34m(values, dtype, copy, errors)[0m
[1;32m    296[0m     [38;5;28;01mreturn[39;00m values[38;5;241m.[39mcopy()
[1;32m    298[0m [38;5;28;01mtry[39;00m:
[0;32m--> 299[0m     new_values [38;5;241m=[39m [43mastype_array[49m[43m([49m[43mvalues[49m[43m,[49m[43m [49m[43mdtype[49m[43m,[49m[43m [49m[43mcopy[49m[38;5;241;43m=[39;49m[43mcopy[49m[43m)[49m
[1;32m    300[0m [38;5;28;01mexcept[39;00m ([38;5;167;01mValueError[39;00m, [38;5;167;01mTypeError[39;00m):
[1;32m    301[0m     [38;5;66;03m# e.g. astype_nansafe can fail on object-dtype of strings[39;00m
[1;32m    302[0m     [38;5;66;03m#  trying to convert to float[39;00m
[1;32m    303[0m     [38;5;28;01mif[39;00m errors [38;5;241m==[39m [38;5;124m"[39m[38;5;124mignore[39m[38;5;124m"[39m:

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/dtypes/astype.py:217[0m, in [0;36mastype_array[0;34m(values, dtype, copy)[0m
[1;32m    214[0m     msg [38;5;241m=[39m [38;5;124mrf[39m[38;5;124m"[39m[38;5;124mcannot astype a datetimelike from [[39m[38;5;132;01m{[39;00mvalues[38;5;241m.[39mdtype[38;5;132;01m}[39;00m[38;5;124m] to [[39m[38;5;132;01m{[39;00mdtype[38;5;132;01m}[39;00m[38;5;124m][39m[38;5;124m"[39m
[1;32m    215[0m     [38;5;28;01mraise[39;00m [38;5;167;01mTypeError[39;00m(msg)
[0;32m--> 217[0m [38;5;28;01mif[39;00m [43mis_datetime64tz_dtype[49m[43m([49m[43mdtype[49m[43m)[49m [38;5;129;01mand[39;00m is_datetime64_dtype(values[38;5;241m.[39mdtype):
[1;32m    218[0m     [38;5;28;01mreturn[39;00m astype_dt64_to_dt64tz(values, dtype, copy, via_utc[38;5;241m=[39m[38;5;28;01mTrue[39;00m)
[1;32m    220[0m [38;5;28;01mif[39;00m is_dtype_equal(values[38;5;241m.[39mdtype, dtype):

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/dtypes/common.py:390[0m, in [0;36mis_datetime64tz_dtype[0;34m(arr_or_dtype)[0m
[1;32m    388[0m [38;5;28;01mif[39;00m arr_or_dtype [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[1;32m    389[0m     [38;5;28;01mreturn[39;00m [38;5;28;01mFalse[39;00m
[0;32m--> 390[0m [38;5;28;01mreturn[39;00m [43mDatetimeTZDtype[49m[38;5;241;43m.[39;49m[43mis_dtype[49m[43m([49m[43marr_or_dtype[49m[43m)[49m

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/dtypes/base.py:312[0m, in [0;36mExtensionDtype.is_dtype[0;34m(cls, dtype)[0m
[1;32m    288[0m [38;5;124;03m"""[39;00m
[1;32m    289[0m [38;5;124;03mCheck if we match 'dtype'.[39;00m
[1;32m    290[0m 
[0;32m   (...)[0m
[1;32m    308[0m [38;5;124;03m   conditions is true for ``dtype.dtype``.[39;00m
[1;32m    309[0m [38;5;124;03m"""[39;00m
[1;32m    310[0m dtype [38;5;241m=[39m [38;5;28mgetattr[39m(dtype, [38;5;124m"[39m[38;5;124mdtype[39m[38;5;124m"[39m, dtype)
[0;32m--> 312[0m [38;5;28;01mif[39;00m [38;5;28;43misinstance[39;49m[43m([49m[43mdtype[49m[43m,[49m[43m [49m[43m([49m[43mABCSeries[49m[43m,[49m[43m [49m[43mABCIndex[49m[43m,[49m[43m [49m[43mABCDataFrame[49m[43m,[49m[43m [49m[43mnp[49m[38;5;241;43m.[39;49m[43mdtype[49m[43m)[49m[43m)[49m:
[1;32m    313[0m     [38;5;66;03m# https://github.com/pandas-dev/pandas/issues/22960[39;00m
[1;32m    314[0m     [38;5;66;03m# avoid passing data to `construct_from_string`. This could[39;00m
[1;32m    315[0m     [38;5;66;03m# cause a FutureWarning from numpy about failing elementwise[39;00m
[1;32m    316[0m     [38;5;66;03m# comparison from, e.g., comparing DataFrame == 'category'.[39;00m
[1;32m    317[0m     [38;5;28;01mreturn[39;00m [38;5;28;01mFalse[39;00m
[1;32m    318[0m [38;5;28;01melif[39;00m dtype [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/dtypes/generic.py:47[0m, in [0;36mcreate_pandas_abc_type.<locals>._instancecheck[0;34m(cls, inst)[0m
[1;32m     45[0m [38;5;129m@classmethod[39m  [38;5;66;03m# type: ignore[misc][39;00m
[1;32m     46[0m [38;5;28;01mdef[39;00m [38;5;21m_instancecheck[39m([38;5;28mcls[39m, inst) [38;5;241m-[39m[38;5;241m>[39m [38;5;28mbool[39m:
[0;32m---> 47[0m     [38;5;28;01mreturn[39;00m [43m_check[49m[43m([49m[43minst[49m[43m)[49m [38;5;129;01mand[39;00m [38;5;129;01mnot[39;00m [38;5;28misinstance[39m(inst, [38;5;28mtype[39m)

File [0;32m~/opt/anaconda3/envs/codeforecon/lib/python3.8/site-packages/pandas/core/dtypes/generic.py:41[0m, in [0;36mcreate_pandas_abc_type.<locals>._check[0;34m(inst)[0m
[1;32m     40[0m [38;5;28;01mdef[39;00m [38;5;21m_check[39m(inst):
[0;32m---> 41[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mgetattr[39;49m[43m([49m[43minst[49m[43m,[49m[43m [49m[43mattr[49m[43m,[49m[43m [49m[38;5;124;43m"[39;49m[38;5;124;43m_typ[39;49m[38;5;124;43m"[39;49m[43m)[49m [38;5;129;01min[39;00m comp

[0;31mRecursionError[0m: maximum recursion depth exceeded while calling a Python object
RecursionError: maximum recursion depth exceeded while calling a Python object

