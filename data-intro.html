
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Working with Data &#8212; Coding for Economists</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <link rel="canonical" href="https://aeturrell.github.io/coding-for-economists/data-intro.html" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Data Transformation" href="data-transformation.html" />
    <link rel="prev" title="Data Analysis Quickstart" href="data-analysis-quickstart.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-9FZQCPFXZJ"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-9FZQCPFXZJ');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/smith_lovelace.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Coding for Economists</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="code-preliminaries.html">
   Preliminaries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="code-basics.html">
   Coding Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="workflow-basics.html">
   Workflow Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="code-where.html">
   Writing Code
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="data-analysis-quickstart.html">
   Data Analysis Quickstart
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Working with Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-transformation.html">
   Data Transformation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-read-and-write.html">
   Reading and Writing Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-numbers.html">
   Numbers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-categorical.html">
   Categorical Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-boolean.html">
   Boolean Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-joining-data.html">
   Joins
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Coding
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="code-best-practice.html">
   Code in Style
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="code-advanced.html">
   More Coding
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Econometrics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="econmt-probability-random.html">
   Probability and Random Processes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="econmt-statistics.html">
   Statistics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="econmt-regression.html">
   Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="econmt-causal-inference.html">
   Causal Inference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="econmt-bayesian.html">
   Bayesian Inference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="econmt-bayes-bambi.html">
   Bayesian Inference Made Easier
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data Visualisation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="vis-intro.html">
   Intro to Data Visualisation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vis-seaborn.html">
   Easy Data Visualisation for Tidy Data with
   <strong>
    Seaborn
   </strong>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vis-matplotlib.html">
   Powerful Data Visualisation with
   <strong>
    Matplotlib
   </strong>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vis-common-plots.html">
   Common Plots
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vis-narrative.html">
   Narrative Data Visualisation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Workflow
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="auto-research-outputs.html">
   Automating Research Outputs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wrkflow-markdown.html">
   Markdown
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wrkflow-quarto.html">
   Combining Code and Text in Quarto Markdown
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  More Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="data-missing-values.html">
   Missing Values
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-exploratory-analysis.html">
   Exploratory Data Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-spreadsheets.html">
   Spreadsheets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-extraction.html">
   Getting Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-databases.html">
   Databases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-sharing.html">
   Sharing Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-advanced.html">
   Advanced Data
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  More Coding
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="code-advcd-best-practice.html">
   Essential Tricks for Better Code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="code-further-advanced.html">
   Yet More Coding
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  More Workflow
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="wrkflow-command-line.html">
   The Command Line
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wrkflow-version-control.html">
   Version Control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wrkflow-environments.html">
   Virtual Code Environments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wrkflow-rap.html">
   Reproducible Analysis
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Craft
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="craft-intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="craft-search.html">
   Putting the Search in Research
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="craft-writing-papers.html">
   Writing Papers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="craft-research-blogs.html">
   Research Blog Posts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="craft-technical-reports.html">
   Writing Technical Reports
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="craft-extended-abstracts.html">
   Extended Abstracts
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Time
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="time-intro.html">
   Introduction to Time
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="time-series.html">
   Time Series
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="time-fcasts-env.html">
   Forecasting Exercises
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Text Analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="text-intro.html">
   Introduction to Text
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="text-regex.html">
   Regular Expressions, aka regex
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="text-nlp.html">
   Natural Language Processing
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Geospatial
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="geo-intro.html">
   Intro to Geo-Spatial Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="geo-vis.html">
   Geo-Spatial Visualisation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  More Data Visualisation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="vis-plotnine.html">
   Data Visualisation using the Grammar of Graphics with
   <strong>
    Plotnine
   </strong>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vis-dashboards.html">
   Dashboards
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="vis-animation.html">
   Animation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Mathematics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="maths-abstract.html">
   Abstract Mathematics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="maths-numerical.html">
   Numerical Mathematics
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Coming from ...
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="coming-from-stata.html">
   Coming from Stata
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coming-from-matlab.html">
   Coming from Matlab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coming-from-r.html">
   Coming from R
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coming-from-excel.html">
   Coming from Excel
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  End Matter
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="acknowledgements.html">
   Acknowledgements and Contributing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zreferences.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://colab.research.google.com/github/aeturrell/coding-for-economists/blob/main/data-intro.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/aeturrell/coding-for-economists"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/aeturrell/coding-for-economists/issues/new?title=Issue%20on%20page%20%2Fdata-intro.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/data-intro.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prerequisites">
     Prerequisites
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-tidy-data">
     Using tidy data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dataframes-and-series">
   Dataframes and Series
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#values-columns-and-the-index">
     Values, Columns, and the Index
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#datatypes">
   Datatypes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#manipulating-rows-in-data-frames">
   Manipulating Rows in Data Frames
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#accessing-rows">
     Accessing Rows
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filtering-rows-with-query">
     Filtering rows with
     <code class="docutils literal notranslate">
      <span class="pre">
       query
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#re-arranging-rows">
     Re-arranging Rows
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercises">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#manipulating-columns">
   Manipulating Columns
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-new-columns">
     Creating New Columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#accessing-columns">
     Accessing Columns
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#eval">
       Eval
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#renaming-columns">
     Renaming Columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#re-ordering-columns">
     Re-ordering Columns
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#review-of-how-to-access-rows-columns-and-values">
   Review of How to Access Rows, Columns, and Values
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slicing">
     Slicing
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#operations-on-rows-columns-and-dataframes">
   Operations on Rows, Columns, and DataFrames
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#operations-that-can-apply-to-both-rows-and-columns">
     Operations that can
     <code class="docutils literal notranslate">
      <span class="pre">
       apply
      </span>
     </code>
     to both rows and columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#operations-on-dataframes">
     Operations on DataFrames
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#column-and-row-exercises">
     Column and Row Exercises
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Working with Data</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prerequisites">
     Prerequisites
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-tidy-data">
     Using tidy data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dataframes-and-series">
   Dataframes and Series
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#values-columns-and-the-index">
     Values, Columns, and the Index
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#datatypes">
   Datatypes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#manipulating-rows-in-data-frames">
   Manipulating Rows in Data Frames
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#accessing-rows">
     Accessing Rows
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filtering-rows-with-query">
     Filtering rows with
     <code class="docutils literal notranslate">
      <span class="pre">
       query
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#re-arranging-rows">
     Re-arranging Rows
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercises">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#manipulating-columns">
   Manipulating Columns
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-new-columns">
     Creating New Columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#accessing-columns">
     Accessing Columns
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#eval">
       Eval
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#renaming-columns">
     Renaming Columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#re-ordering-columns">
     Re-ordering Columns
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#review-of-how-to-access-rows-columns-and-values">
   Review of How to Access Rows, Columns, and Values
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slicing">
     Slicing
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#operations-on-rows-columns-and-dataframes">
   Operations on Rows, Columns, and DataFrames
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#operations-that-can-apply-to-both-rows-and-columns">
     Operations that can
     <code class="docutils literal notranslate">
      <span class="pre">
       apply
      </span>
     </code>
     to both rows and columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#operations-on-dataframes">
     Operations on DataFrames
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#column-and-row-exercises">
     Column and Row Exercises
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="working-with-data">
<span id="id1"></span><h1>Working with Data<a class="headerlink" href="#working-with-data" title="Permalink to this headline">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>The previous chapter was just a quick tour of what can be done with a single tabular dataset (a ‘dataframe’). Dataframes are the most frequently used structure for working with data; they do everything a spreadsheet does and a whole lot more——as you’ll see! In this chapter, we’ll go deeper into working with data and dataframes.</p>
<p>In this chapter, you’ll get really good overview to the <a class="reference external" href="https://pandas.pydata.org/"><strong>pandas</strong></a> package, the core data manipulation library in Python. The name is derived from ‘panel data’ but it’s suited to any tabular data, and can be used to work with more complex data structures too. We <em>won’t</em> cover reading in or writing data here; see the next chapter for that.</p>
<p>This chapter is hugely indebted to the fantastic <a class="reference external" href="https://jakevdp.github.io/PythonDataScienceHandbook/">Python Data Science Handbook</a> by Jake Vanderplas. Remember, if you get stuck with pandas, there is brilliant <a class="reference external" href="https://pandas.pydata.org/docs/user_guide/index.html">documentation</a> and a fantastic set of <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/getting_started/intro_tutorials/index.html">introductory tutorials</a> on the <strong>pandas</strong> website. These notes are heavily indebted to those introductory tutorials.</p>
<section id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">#</a></h3>
<p>This chapter uses the <strong>pandas</strong>, <strong>seaborn</strong>, and <strong>numpy</strong> packages. If you’re running this code, you may need to install these packages, which you can do using either <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">packagename</span></code> or <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">packagename</span></code> on your computer’s command line. If you’re running this page in Google Colab, you can install new packages by running <code class="docutils literal notranslate"><span class="pre">!pip</span> <span class="pre">install</span> <span class="pre">packagename</span></code> in a new code cell but you will need to restart the Colab notebook for the change to take effect. There’s a brief guide on installing packages in the Chapter on <a class="reference internal" href="code-preliminaries.html#code-preliminaries"><span class="std std-ref">Preliminaries</span></a>.</p>
</section>
<section id="using-tidy-data">
<h3>Using tidy data<a class="headerlink" href="#using-tidy-data" title="Permalink to this headline">#</a></h3>
<p>As an aside, if you’re working with tabular data, it’s good to try and use a so-called ‘tidy data’ format. This is data with one observation per row, and one variable per column, like so:</p>
<p><img alt="" src="https://d33wubrfki0l68.cloudfront.net/6f1ddb544fc5c69a2478e444ab8112fb0eea23f8/91adc/images/tidy-1.png" /></p>
<p>Tidy data aren’t going to be appropriate <em>every</em> time and in every case, but they’re a really, really good default for tabular data. Once you use it as your default, it’s easier to think about how to perform subsequent operations. Some plotting libraries, such as <strong>seaborn</strong>, take that your data are in tidy format as a given. And many operations that you can perform on dataframes (the objects that hold tabular data within many programming languages) are easier when you have tidy data. If you’re writing out data to file to share, putting it in tidy format is a really good idea.</p>
<p>Of course, <em>getting</em> your messy dataset into a tidy format may take a bit of work… but we’re about to enter the exciting world of coding for data analysis and the tools you’ll see in the rest of this chapter will help you to ‘wrangle’ even the most messy of datasets.</p>
<p>Having said that tidy data are great, and they are, one of standard data library <strong>pandas</strong>’ advantages relative to other data analysis libraries is that it isn’t <em>too</em> tied to tidy data and can navigate awkward non-tidy data manipulation tasks happily too.</p>
</section>
</section>
<section id="dataframes-and-series">
<h2>Dataframes and Series<a class="headerlink" href="#dataframes-and-series" title="Permalink to this headline">#</a></h2>
<p>Let’s start with the absolute basics. The most basic <strong>pandas</strong> object is a dataframe. A DataFrame is a 2-dimensional data structure that can store data of different types (including characters, integers, floating point values, categorical data, even lists) in columns.</p>
<p><img alt="" src="https://pandas.pydata.org/docs/_images/01_table_dataframe.svg" /></p>
<p>Perhaps the single most important feature of <strong>pandas</strong> dataframes to remember is that the <em>index</em>, the special column on the left hand side that tracks the rows of data, is all important. Keep in mind the question, “what is the index doing in this operation” for every process you apply to a <strong>pandas</strong> dataframe and you won’t go far wrong.</p>
<p>We’ll now import the packages we’ll need for this chapter and set a random number seed (some examples use randomly generated data).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Set seed for random numbers</span>
<span class="n">seed_for_prng</span> <span class="o">=</span> <span class="mi">78557</span>
<span class="n">prng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed_for_prng</span><span class="p">)</span>  <span class="c1"># prng=probabilistic random number generator</span>
</pre></div>
</div>
</div>
</div>
<p>We’ll look at a dataframe of the <em>penguins</em> dataset <span id="id2">[<a class="reference internal" href="zreferences.html#id36" title="Allison Marie Horst, Alison Presmanes Hill, and Kristen B Gorman. Palmerpenguins: palmer archipelago (antarctica) penguin data. R package version 0.1.0, 2020.">Horst <em>et al.</em>, 2020</a>]</span>, which comes build in to the <strong>seaborn</strong> package (which we imported into our session as <code class="docutils literal notranslate"><span class="pre">sns</span></code>). To show just the first 5 rows, we’ll be using the <code class="docutils literal notranslate"><span class="pre">head()</span></code> method (there’s also a <code class="docutils literal notranslate"><span class="pre">tail()</span></code> method).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now let&#39;s load up a dataset from the seaborn package (imported as sns)</span>
<span class="n">penguins</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;penguins&quot;</span><span class="p">)</span>
<span class="n">penguins</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>36.7</td>
      <td>19.3</td>
      <td>193.0</td>
      <td>3450.0</td>
      <td>Female</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>What just happened? We loaded a pandas dataframe we named <code class="docutils literal notranslate"><span class="pre">penguins</span></code> and showed its contents. You can see the column names in bold, and the index on the left hand side. Just to double check it <em>is</em> a pandas dataframe, we can call type on <code class="docutils literal notranslate"><span class="pre">penguins</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">penguins</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.frame.DataFrame
</pre></div>
</div>
</div>
</div>
<p>And if we want a bit more information about what we imported (including the datatypes of the columns):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">penguins</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 344 entries, 0 to 343
Data columns (total 7 columns):
 #   Column             Non-Null Count  Dtype  
---  ------             --------------  -----  
 0   species            344 non-null    object 
 1   island             344 non-null    object 
 2   bill_length_mm     342 non-null    float64
 3   bill_depth_mm      342 non-null    float64
 4   flipper_length_mm  342 non-null    float64
 5   body_mass_g        342 non-null    float64
 6   sex                333 non-null    object 
dtypes: float64(4), object(3)
memory usage: 18.9+ KB
</pre></div>
</div>
</div>
</div>
<p>Remember that everything in Python is an object, and our dataframe is no exception. Each dataframe is made up of a set of series that, in a dataframe, become columns: but you can turn a single series into a dataframe too.</p>
<p><img alt="" src="https://pandas.pydata.org/docs/_images/01_table_series.svg" /></p>
<p>Let’s see a couple of ways of creating some series from raw data:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># From a list:</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">19.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">])</span>
<span class="n">s1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     1.0
1     6.0
2    19.0
3     2.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># From a dictionary</span>
<span class="n">population_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;California&quot;</span><span class="p">:</span> <span class="mi">38332521</span><span class="p">,</span>
    <span class="s2">&quot;Texas&quot;</span><span class="p">:</span> <span class="mi">26448193</span><span class="p">,</span>
    <span class="s2">&quot;New York&quot;</span><span class="p">:</span> <span class="mi">19651127</span><span class="p">,</span>
    <span class="s2">&quot;Florida&quot;</span><span class="p">:</span> <span class="mi">19552860</span><span class="p">,</span>
    <span class="s2">&quot;Illinois&quot;</span><span class="p">:</span> <span class="mi">12882135</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">population_dict</span><span class="p">)</span>
<span class="n">s2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>California    38332521
Texas         26448193
New York      19651127
Florida       19552860
Illinois      12882135
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Note that in each case there is no column name (because this is a series, not a dataframe), and there <em>is</em> an index. The index is automatically created if we don’t specify it; in the third example, by passing a dictionary we implicitly asked for the index to be the locations we supplied.</p>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Create a <strong>pandas</strong> series of ascending integers using the Python built-in <code class="docutils literal notranslate"><span class="pre">range(start,</span> <span class="pre">stop)</span></code> function.</p>
</div>
<p>If you ever need to get the data ‘out’ of a series or dataframe, you can just call the <code class="docutils literal notranslate"><span class="pre">values</span></code> method on the object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([38332521, 26448193, 19651127, 19552860, 12882135])
</pre></div>
</div>
</div>
</div>
<p>If you ever want to turn a series into a dataframe, just called <code class="docutils literal notranslate"><span class="pre">pd.DataFrame(series)</span></code> on it. Note that while series have an index and an object name (eg <code class="docutils literal notranslate"><span class="pre">s2</span></code> above), they don’t have any column labels because they only have one column.</p>
<p>Now let’s try creating our own dataframe with more than one column of data using a <em>dictionary</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span><span class="p">),</span>
        <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span>
        <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">([</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;train&quot;</span><span class="p">]),</span>
        <span class="s2">&quot;E&quot;</span><span class="p">:</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>3</td>
      <td>test</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>3</td>
      <td>train</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>3</td>
      <td>test</td>
      <td>foo</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>3</td>
      <td>train</td>
      <td>foo</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Remember, curly brackets in the format <code class="docutils literal notranslate"><span class="pre">{key:</span> <span class="pre">value}</span></code> denote a dictionary. In the above example, the <code class="docutils literal notranslate"><span class="pre">pd.DataFrame()</span></code> function understands that any single value entries in the dictionary that is passed, such as <code class="docutils literal notranslate"><span class="pre">{'A':</span> <span class="pre">1.}</span></code>, should be repeated as many times as are needed to match the longest series in the dictionary (4 in the above example).</p>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Using a dictionary structure like the one above, create a <strong>pandas</strong> dataframe from the series you created in the previous exercise so that the name of the column is ‘series’.</p>
</div>
<p>Another way to create dataframes is to pass a bunch of series (note that <code class="docutils literal notranslate"><span class="pre">index</span></code>, <code class="docutils literal notranslate"><span class="pre">columns</span></code>, and <code class="docutils literal notranslate"><span class="pre">dtype</span></code> are optional–you can just specify the data):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">36</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)),</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">],</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;col&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)],</span>
    <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col0</th>
      <th>col1</th>
      <th>col2</th>
      <th>col3</th>
      <th>col4</th>
      <th>col5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>6.0</td>
      <td>7.0</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>12.0</td>
      <td>13.0</td>
      <td>14.0</td>
      <td>15.0</td>
      <td>16.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>d</th>
      <td>18.0</td>
      <td>19.0</td>
      <td>20.0</td>
      <td>21.0</td>
      <td>22.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>24.0</td>
      <td>25.0</td>
      <td>26.0</td>
      <td>27.0</td>
      <td>28.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>f</th>
      <td>30.0</td>
      <td>31.0</td>
      <td>32.0</td>
      <td>33.0</td>
      <td>34.0</td>
      <td>35.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">reshape</span></code> takes an input and puts it into a given shape (a 6 by 6 matrix in the above example).</p>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Create a <strong>pandas</strong> dataframe using the <code class="docutils literal notranslate"><span class="pre">data=</span></code>, <code class="docutils literal notranslate"><span class="pre">index=</span></code>, and <code class="docutils literal notranslate"><span class="pre">columns=</span></code> keyword arguments. The data should consist of one column with ascending integers from 0 to 5, the column name should be “series”, and the index should be the first 5 letters of the alphabet. Remember that the <code class="docutils literal notranslate"><span class="pre">index</span></code> and <code class="docutils literal notranslate"><span class="pre">columns</span></code> keyword arguments expect an iterable of some kind (not just a string).</p>
</div>
<section id="values-columns-and-the-index">
<h3>Values, Columns, and the Index<a class="headerlink" href="#values-columns-and-the-index" title="Permalink to this headline">#</a></h3>
<p>You’ll have seen that there are three different things that make up a dataframe: the values that are in the cells, the column names, and the index. The column and index can take on values that are the same as the values in a dataframe; string, int, float, datetime, and more.</p>
<p>It’s pretty obvious what role the columns play: they keep track of the name of different sets of values. But for people who may have seen other dataframe-like libraries, the role played by the index may be less familiar. The easiest way to think about a <strong>pandas</strong> index is that it does for row values what the columns do for columnar values: it’s a way of keeping track of what individual roles are and it <em>doesn’t</em> get used for calculations (just as summing a column ignores the name of the row).</p>
<p>Here’s an example to show this. Let’s first create a simple dataframe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;col0&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;col1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;col2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;col3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">],</span>
        <span class="s2">&quot;col4&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="s2">&quot;gamma&quot;</span><span class="p">,</span> <span class="s2">&quot;gamma&quot;</span><span class="p">,</span> <span class="s2">&quot;gamma&quot;</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;row&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span>
<span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col0</th>
      <th>col1</th>
      <th>col2</th>
      <th>col3</th>
      <th>col4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>a</td>
      <td>alpha</td>
    </tr>
    <tr>
      <th>row1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>b</td>
      <td>gamma</td>
    </tr>
    <tr>
      <th>row2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>b</td>
      <td>gamma</td>
    </tr>
    <tr>
      <th>row3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>a</td>
      <td>gamma</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If we add one to the integer columns in the dataframe, this is what we get (note we’re not saving the result because we don’t have an assignment step with an <code class="docutils literal notranslate"><span class="pre">=</span></code> sign):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;col0&quot;</span><span class="p">,</span> <span class="s2">&quot;col1&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">]]</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col0</th>
      <th>col1</th>
      <th>col2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>row0</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>row1</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>row2</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>row3</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now let’s use <code class="docutils literal notranslate"><span class="pre">col0</span></code> as our index instead of the original labels we created and add one to the remaining numeric columns (this time assigning the result back to the original columns):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;col0&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[[</span><span class="s2">&quot;col1&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;col1&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">]]</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col1</th>
      <th>col2</th>
      <th>col3</th>
      <th>col4</th>
    </tr>
    <tr>
      <th>col0</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>a</td>
      <td>alpha</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>b</td>
      <td>gamma</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>b</td>
      <td>gamma</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>a</td>
      <td>gamma</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>What was a column name has become an index name (<code class="docutils literal notranslate"><span class="pre">col0</span></code>, which you can change with <code class="docutils literal notranslate"><span class="pre">df.index.name='newname'</span></code>) and, when we do add one, it isn’t applied to the index values (here, all zeros). Even though their datatype is <code class="docutils literal notranslate"><span class="pre">int</span></code>, for integer, the index entries are now acting as a label for each row—not as values in the dataframe.</p>
<p>An index can be useful for keeping track of what’s going on, and it’s particularly convenient for some datetime operations.</p>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Working with the dataframe above add the phrase ” more text” onto the two string columns, <code class="docutils literal notranslate"><span class="pre">col3</span></code> and <code class="docutils literal notranslate"><span class="pre">col4</span></code>. Remember that strings respect the <code class="docutils literal notranslate"><span class="pre">+</span></code> operator.</p>
</div>
<p>Whenever you use <code class="docutils literal notranslate"><span class="pre">groupby</span></code> (and some other operations), the columns you use to perform the operation are set as the index of the returned dataframe (you can have multiple index columns). To get back those back to being columns, use the <code class="docutils literal notranslate"><span class="pre">reset_index()</span></code> method like so:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;col3&quot;</span><span class="p">,</span> <span class="s2">&quot;col4&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>col1</th>
      <th>col2</th>
    </tr>
    <tr>
      <th>col3</th>
      <th>col4</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">a</th>
      <th>alpha</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>gamma</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>b</th>
      <th>gamma</th>
      <td>2</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;col3&quot;</span><span class="p">,</span> <span class="s2">&quot;col4&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col3</th>
      <th>col4</th>
      <th>col1</th>
      <th>col2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>alpha</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a</td>
      <td>gamma</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>b</td>
      <td>gamma</td>
      <td>2</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Group the <code class="docutils literal notranslate"><span class="pre">df</span></code> object above by <code class="docutils literal notranslate"><span class="pre">col1</span></code> and <code class="docutils literal notranslate"><span class="pre">col2</span></code> using the <code class="docutils literal notranslate"><span class="pre">first</span></code> aggregation operation in place of <code class="docutils literal notranslate"><span class="pre">sum</span></code> above. Reset the index to return <code class="docutils literal notranslate"><span class="pre">col1</span></code> and <code class="docutils literal notranslate"><span class="pre">col2</span></code> to being regular columns.</p>
</div>
</section>
</section>
<section id="datatypes">
<h2>Datatypes<a class="headerlink" href="#datatypes" title="Permalink to this headline">#</a></h2>
<p>Pandas has some built-in datatypes (some are the basic Python datatypes) that will make your life a <em>lot</em> easier if you work with them. Why bother specifying datatypes? Languages like Python let you get away with having pretty much anything in your columns. But this can be a problem: sometimes you’ll end up mixing integers, strings, the generic ‘object’ datatype, and more by mistake. By ensuring that columns conform to a datatype, you can save yourself from some of the trials that come with these mixed datatypes. Some of the most important datatypes for dataframe are string, float, categorical, datetime, int, and boolean.</p>
<p>Typically, you’ll read in a dataset where the dataypes of the columns are a mess. One of the first things you’ll want to do is sort these out. Here’s an example dataset showing how to set the datatypes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;string1&quot;</span><span class="p">,</span> <span class="s2">&quot;string2&quot;</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">3.4</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;type_a&quot;</span><span class="p">,</span> <span class="s2">&quot;type_b&quot;</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;01-01-1999&quot;</span><span class="p">,</span> <span class="s2">&quot;01-01-2000&quot;</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;string_col&quot;</span><span class="p">,</span>
    <span class="s2">&quot;double_col&quot;</span><span class="p">,</span>
    <span class="s2">&quot;category_col&quot;</span><span class="p">,</span>
    <span class="s2">&quot;datetime_col&quot;</span><span class="p">,</span>
    <span class="s2">&quot;integer_col&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bool_col&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 2 entries, 0 to 1
Data columns (total 6 columns):
 #   Column        Non-Null Count  Dtype 
---  ------        --------------  ----- 
 0   string_col    2 non-null      object
 1   double_col    2 non-null      object
 2   category_col  2 non-null      object
 3   datetime_col  2 non-null      object
 4   integer_col   2 non-null      object
 5   bool_col      2 non-null      object
dtypes: object(6)
memory usage: 224.0+ bytes
</pre></div>
</div>
</div>
</div>
<p>Note that the data type for all of these columns is the generic ‘Object’ (you can see this from the <code class="docutils literal notranslate"><span class="pre">Dtype</span></code> column that is printed when you use <code class="docutils literal notranslate"><span class="pre">df.info()</span></code>). Let’s fix that:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">string_col</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;string_col&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;string&quot;</span><span class="p">),</span>
    <span class="n">double_col</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;double_col&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;double&quot;</span><span class="p">),</span>
    <span class="n">category_col</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;category_col&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">),</span>
    <span class="n">datetime_col</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;datetime_col&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;datetime64[ns]&quot;</span><span class="p">),</span>
    <span class="n">integer_col</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;integer_col&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">),</span>
    <span class="n">bool_col</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;bool_col&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;bool&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 2 entries, 0 to 1
Data columns (total 6 columns):
 #   Column        Non-Null Count  Dtype         
---  ------        --------------  -----         
 0   string_col    2 non-null      string        
 1   double_col    2 non-null      float64       
 2   category_col  2 non-null      category      
 3   datetime_col  2 non-null      datetime64[ns]
 4   integer_col   2 non-null      int64         
 5   bool_col      2 non-null      bool          
dtypes: bool(1), category(1), datetime64[ns](1), float64(1), int64(1), string(1)
memory usage: 320.0 bytes
</pre></div>
</div>
</div>
</div>
<p>Once you have applied datatypes to the columns in your dataframe, tools like <a class="reference external" href="https://github.com/aeturrell/skimpy">skimpy</a> (install using <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">skimpy</span></code> on the command line or <code class="docutils literal notranslate"><span class="pre">!pip</span> <span class="pre">install</span> <span class="pre">skimpy</span></code> within a Colab code cell if you’re using Google Colab) can then provide richer summaries of your data. (Skimpy will try and infer column data types, but it’s not perfect.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skimpy</span> <span class="kn">import</span> <span class="n">skim</span>

<span class="n">skim</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">╭──────────────────────────────────────────────── skimpy summary ─────────────────────────────────────────────────╮
│ <span style="font-style: italic">         Data Summary         </span> <span style="font-style: italic">      Data Types       </span> <span style="font-style: italic">       Categories        </span>                                │
│ ┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓ ┏━━━━━━━━━━━━━┳━━━━━━━┓ ┏━━━━━━━━━━━━━━━━━━━━━━━┓                                │
│ ┃<span style="color: #008080; text-decoration-color: #008080; font-weight: bold"> dataframe         </span>┃<span style="color: #008080; text-decoration-color: #008080; font-weight: bold"> Values </span>┃ ┃<span style="color: #008080; text-decoration-color: #008080; font-weight: bold"> Column Type </span>┃<span style="color: #008080; text-decoration-color: #008080; font-weight: bold"> Count </span>┃ ┃<span style="color: #008080; text-decoration-color: #008080; font-weight: bold"> Categorical Variables </span>┃                                │
│ ┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩ ┡━━━━━━━━━━━━━╇━━━━━━━┩ ┡━━━━━━━━━━━━━━━━━━━━━━━┩                                │
│ │ Number of rows    │ 2      │ │ string      │ 1     │ │ category_col          │                                │
│ │ Number of columns │ 6      │ │ float64     │ 1     │ └───────────────────────┘                                │
│ └───────────────────┴────────┘ │ category    │ 1     │                                                          │
│                                │ datetime64  │ 1     │                                                          │
│                                │ int64       │ 1     │                                                          │
│                                │ bool        │ 1     │                                                          │
│                                └─────────────┴───────┘                                                          │
│ <span style="font-style: italic">                                                    number                                                    </span>  │
│ ┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━┓  │
│ ┃<span style="font-weight: bold"> column_name         </span>┃<span style="font-weight: bold"> NA    </span>┃<span style="font-weight: bold"> NA %     </span>┃<span style="font-weight: bold"> mean    </span>┃<span style="font-weight: bold"> sd      </span>┃<span style="font-weight: bold"> p0     </span>┃<span style="font-weight: bold"> p25    </span>┃<span style="font-weight: bold"> p75    </span>┃<span style="font-weight: bold"> p100    </span>┃<span style="font-weight: bold"> hist     </span>┃  │
│ ┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━┩  │
│ │ <span style="color: #af87ff; text-decoration-color: #af87ff">double_col         </span> │ <span style="color: #008080; text-decoration-color: #008080">    0</span> │ <span style="color: #008080; text-decoration-color: #008080">       0</span> │ <span style="color: #008080; text-decoration-color: #008080">    2.3</span> │ <span style="color: #008080; text-decoration-color: #008080">    1.6</span> │ <span style="color: #008080; text-decoration-color: #008080">   1.2</span> │ <span style="color: #008080; text-decoration-color: #008080">   1.8</span> │ <span style="color: #008080; text-decoration-color: #008080">   2.8</span> │ <span style="color: #008080; text-decoration-color: #008080">    3.4</span> │ <span style="color: #008000; text-decoration-color: #008000"> █    █ </span> │  │
│ │ <span style="color: #af87ff; text-decoration-color: #af87ff">integer_col        </span> │ <span style="color: #008080; text-decoration-color: #008080">    0</span> │ <span style="color: #008080; text-decoration-color: #008080">       0</span> │ <span style="color: #008080; text-decoration-color: #008080">    1.5</span> │ <span style="color: #008080; text-decoration-color: #008080">   0.71</span> │ <span style="color: #008080; text-decoration-color: #008080">     1</span> │ <span style="color: #008080; text-decoration-color: #008080">   1.2</span> │ <span style="color: #008080; text-decoration-color: #008080">   1.8</span> │ <span style="color: #008080; text-decoration-color: #008080">      2</span> │ <span style="color: #008000; text-decoration-color: #008000"> █    █ </span> │  │
│ └─────────────────────┴───────┴──────────┴─────────┴─────────┴────────┴────────┴────────┴─────────┴──────────┘  │
│ <span style="font-style: italic">                                                   category                                                   </span>  │
│ ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓  │
│ ┃<span style="font-weight: bold"> column_name                        </span>┃<span style="font-weight: bold"> NA        </span>┃<span style="font-weight: bold"> NA %          </span>┃<span style="font-weight: bold"> ordered               </span>┃<span style="font-weight: bold"> unique            </span>┃  │
│ ┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩  │
│ │ <span style="color: #af87ff; text-decoration-color: #af87ff">category_col                      </span> │ <span style="color: #008080; text-decoration-color: #008080">        0</span> │ <span style="color: #008080; text-decoration-color: #008080">            0</span> │ <span style="color: #00d7ff; text-decoration-color: #00d7ff">False                </span> │ <span style="color: #008080; text-decoration-color: #008080">                2</span> │  │
│ └────────────────────────────────────┴───────────┴───────────────┴───────────────────────┴───────────────────┘  │
│ <span style="font-style: italic">                                                   datetime                                                   </span>  │
│ ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┓  │
│ ┃<span style="font-weight: bold"> column_name                   </span>┃<span style="font-weight: bold"> NA      </span>┃<span style="font-weight: bold"> NA %        </span>┃<span style="font-weight: bold"> first                    </span>┃<span style="font-weight: bold"> last                    </span>┃  │
│ ┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━┩  │
│ │ <span style="color: #af87ff; text-decoration-color: #af87ff">datetime_col                 </span> │ <span style="color: #008080; text-decoration-color: #008080">      0</span> │ <span style="color: #008080; text-decoration-color: #008080">          0</span> │ <span style="color: #800000; text-decoration-color: #800000">       1999-01-01       </span> │ <span style="color: #800000; text-decoration-color: #800000">      2000-01-01       </span> │  │
│ └───────────────────────────────┴─────────┴─────────────┴──────────────────────────┴─────────────────────────┘  │
│ <span style="font-style: italic">                                                    string                                                    </span>  │
│ ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━┓  │
│ ┃<span style="font-weight: bold"> column_name               </span>┃<span style="font-weight: bold"> NA      </span>┃<span style="font-weight: bold"> NA %       </span>┃<span style="font-weight: bold"> words per row                </span>┃<span style="font-weight: bold"> total words              </span>┃  │
│ ┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━┩  │
│ │ <span style="color: #af87ff; text-decoration-color: #af87ff">string_col               </span> │ <span style="color: #008080; text-decoration-color: #008080">      0</span> │ <span style="color: #008080; text-decoration-color: #008080">         0</span> │ <span style="color: #008080; text-decoration-color: #008080">                           1</span> │ <span style="color: #008080; text-decoration-color: #008080">                       2</span> │  │
│ └───────────────────────────┴─────────┴────────────┴──────────────────────────────┴──────────────────────────┘  │
│ <span style="font-style: italic">                                                     bool                                                     </span>  │
│ ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┓  │
│ ┃<span style="font-weight: bold"> column_name                        </span>┃<span style="font-weight: bold"> true            </span>┃<span style="font-weight: bold"> true rate                     </span>┃<span style="font-weight: bold"> hist                </span>┃  │
│ ┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━┩  │
│ │ <span style="color: #af87ff; text-decoration-color: #af87ff">bool_col                          </span> │ <span style="color: #008080; text-decoration-color: #008080">              2</span> │ <span style="color: #008080; text-decoration-color: #008080">                            1</span> │ <span style="color: #008000; text-decoration-color: #008000">          █        </span> │  │
│ └────────────────────────────────────┴─────────────────┴───────────────────────────────┴─────────────────────┘  │
╰────────────────────────────────────────────────────── End ──────────────────────────────────────────────────────╯
</pre>
</div></div>
</div>
<p>There’s a lot more on exploratory data analysis in the Chapter on <a class="reference internal" href="data-exploratory-analysis.html#data-exploratory-analysis"><span class="std std-ref">Exploratory Data Analysis</span></a>.</p>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Apply the relevant types to this dataframe:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;col0&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;col1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;col2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;col3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">],</span>
        <span class="s2">&quot;col4&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="s2">&quot;gamma&quot;</span><span class="p">,</span> <span class="s2">&quot;gamma&quot;</span><span class="p">,</span> <span class="s2">&quot;gamma&quot;</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;row&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>If you’re creating a series or dataframe from scratch, here’s how to start off with these datatypes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">str_s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;string1&quot;</span><span class="p">,</span> <span class="s2">&quot;string2&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">)</span>
<span class="n">float_s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">3.4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">cat_s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;type_a&quot;</span><span class="p">,</span> <span class="s2">&quot;type_b&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>
<span class="n">date_s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;01-01-1999&quot;</span><span class="p">,</span> <span class="s2">&quot;01-01-2000&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;datetime64[ns]&quot;</span><span class="p">)</span>
<span class="n">int_s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
<span class="n">bool_s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">str_s</span><span class="p">,</span> <span class="n">float_s</span><span class="p">,</span> <span class="n">cat_s</span><span class="p">,</span> <span class="n">date_s</span><span class="p">,</span> <span class="n">int_s</span><span class="p">,</span> <span class="n">bool_s</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 2 entries, 0 to 1
Data columns (total 6 columns):
 #   Column  Non-Null Count  Dtype         
---  ------  --------------  -----         
 0   0       2 non-null      string        
 1   1       2 non-null      float64       
 2   2       2 non-null      category      
 3   3       2 non-null      datetime64[ns]
 4   4       2 non-null      int64         
 5   5       2 non-null      bool          
dtypes: bool(1), category(1), datetime64[ns](1), float64(1), int64(1), string(1)
memory usage: 320.0 bytes
</pre></div>
</div>
</div>
</div>
</section>
<section id="manipulating-rows-in-data-frames">
<h2>Manipulating Rows in Data Frames<a class="headerlink" href="#manipulating-rows-in-data-frames" title="Permalink to this headline">#</a></h2>
<p>So, you’ve got a dataframe and you’d like to cut it down to only work with some rows or do some operations on specific rows. This section will show you how to do exactly that.</p>
<p>Let’s create some fake data to show how this works.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">36</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)),</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">],</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;col&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)],</span>
    <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;col6&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;apple&quot;</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="s2">&quot;pineapple&quot;</span><span class="p">,</span> <span class="s2">&quot;mango&quot;</span><span class="p">,</span> <span class="s2">&quot;kiwi&quot;</span><span class="p">,</span> <span class="s2">&quot;lemon&quot;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col0</th>
      <th>col1</th>
      <th>col2</th>
      <th>col3</th>
      <th>col4</th>
      <th>col5</th>
      <th>col6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>apple</td>
    </tr>
    <tr>
      <th>b</th>
      <td>6.0</td>
      <td>7.0</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>11.0</td>
      <td>orange</td>
    </tr>
    <tr>
      <th>c</th>
      <td>12.0</td>
      <td>13.0</td>
      <td>14.0</td>
      <td>15.0</td>
      <td>16.0</td>
      <td>17.0</td>
      <td>pineapple</td>
    </tr>
    <tr>
      <th>d</th>
      <td>18.0</td>
      <td>19.0</td>
      <td>20.0</td>
      <td>21.0</td>
      <td>22.0</td>
      <td>23.0</td>
      <td>mango</td>
    </tr>
    <tr>
      <th>e</th>
      <td>24.0</td>
      <td>25.0</td>
      <td>26.0</td>
      <td>27.0</td>
      <td>28.0</td>
      <td>29.0</td>
      <td>kiwi</td>
    </tr>
    <tr>
      <th>f</th>
      <td>30.0</td>
      <td>31.0</td>
      <td>32.0</td>
      <td>33.0</td>
      <td>34.0</td>
      <td>35.0</td>
      <td>lemon</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="accessing-rows">
<h3>Accessing Rows<a class="headerlink" href="#accessing-rows" title="Permalink to this headline">#</a></h3>
<p><img alt="Depiction of subsetting certain rows" src="https://pandas.pydata.org/docs/_images/03_subset_rows.svg" /></p>
<p>To access a particular row directly, you can use <code class="docutils literal notranslate"><span class="pre">df.loc['rowname']</span></code> or <code class="docutils literal notranslate"><span class="pre">df.loc[['rowname1',</span> <span class="pre">'rowname1']]</span></code> for two different rows.</p>
<p>For example,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col0</th>
      <th>col1</th>
      <th>col2</th>
      <th>col3</th>
      <th>col4</th>
      <th>col5</th>
      <th>col6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>apple</td>
    </tr>
    <tr>
      <th>b</th>
      <td>6.0</td>
      <td>7.0</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>11.0</td>
      <td>orange</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>But you can also access particular rows based on their location in the dataframe using <code class="docutils literal notranslate"><span class="pre">.iloc</span></code>. Remember that Python indices begin from zero, so to retrieve the first row you would use <code class="docutils literal notranslate"><span class="pre">.iloc[0]</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>col0      0.0
col1      1.0
col2      2.0
col3      3.0
col4      4.0
col5      5.0
col6    apple
Name: a, dtype: object
</pre></div>
</div>
</div>
</div>
<p>This works for multiple rows too. Let’s grab the first and third rows (in positions 0 and 2) by passing a list of positions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col0</th>
      <th>col1</th>
      <th>col2</th>
      <th>col3</th>
      <th>col4</th>
      <th>col5</th>
      <th>col6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>apple</td>
    </tr>
    <tr>
      <th>c</th>
      <td>12.0</td>
      <td>13.0</td>
      <td>14.0</td>
      <td>15.0</td>
      <td>16.0</td>
      <td>17.0</td>
      <td>pineapple</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>There are other ways to access multiple rows that make use of <em>slicing</em> but we’ll leave that topic for another time.</p>
</section>
<section id="filtering-rows-with-query">
<h3>Filtering rows with <code class="docutils literal notranslate"><span class="pre">query</span></code><a class="headerlink" href="#filtering-rows-with-query" title="Permalink to this headline">#</a></h3>
<p>As with the flights example, we can also filter rows based on a condition using <code class="docutils literal notranslate"><span class="pre">query</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;col6 == &#39;kiwi&#39; or col6 == &#39;pineapple&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col0</th>
      <th>col1</th>
      <th>col2</th>
      <th>col3</th>
      <th>col4</th>
      <th>col5</th>
      <th>col6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>c</th>
      <td>12.0</td>
      <td>13.0</td>
      <td>14.0</td>
      <td>15.0</td>
      <td>16.0</td>
      <td>17.0</td>
      <td>pineapple</td>
    </tr>
    <tr>
      <th>e</th>
      <td>24.0</td>
      <td>25.0</td>
      <td>26.0</td>
      <td>27.0</td>
      <td>28.0</td>
      <td>29.0</td>
      <td>kiwi</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>For numbers, you can also use the greater than and less than signs:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;col0 &gt; 6&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col0</th>
      <th>col1</th>
      <th>col2</th>
      <th>col3</th>
      <th>col4</th>
      <th>col5</th>
      <th>col6</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>c</th>
      <td>12.0</td>
      <td>13.0</td>
      <td>14.0</td>
      <td>15.0</td>
      <td>16.0</td>
      <td>17.0</td>
      <td>pineapple</td>
    </tr>
    <tr>
      <th>d</th>
      <td>18.0</td>
      <td>19.0</td>
      <td>20.0</td>
      <td>21.0</td>
      <td>22.0</td>
      <td>23.0</td>
      <td>mango</td>
    </tr>
    <tr>
      <th>e</th>
      <td>24.0</td>
      <td>25.0</td>
      <td>26.0</td>
      <td>27.0</td>
      <td>28.0</td>
      <td>29.0</td>
      <td>kiwi</td>
    </tr>
    <tr>
      <th>f</th>
      <td>30.0</td>
      <td>31.0</td>
      <td>32.0</td>
      <td>33.0</td>
      <td>34.0</td>
      <td>35.0</td>
      <td>lemon</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In fact, there are lots of options that work with <code class="docutils literal notranslate"><span class="pre">query</span></code>: as well as <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> (greater than), you can use <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code> (greater than or equal to), <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> (less than), <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code> (less than or equal to), <code class="docutils literal notranslate"><span class="pre">==</span></code> (equal to), and <code class="docutils literal notranslate"><span class="pre">!=</span></code> (not equal to). You can also use the commands <code class="docutils literal notranslate"><span class="pre">and</span></code> as well as <code class="docutils literal notranslate"><span class="pre">or</span></code> to combine multiple conditions. Below is an example of <code class="docutils literal notranslate"><span class="pre">and</span></code> from the <code class="docutils literal notranslate"><span class="pre">flights</span></code> dataframe, which we’ll load first (NB this is a big file!):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flights</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s2">&quot;https://github.com/aeturrell/coding-for-economists/blob/main/data/flights.parquet?raw=true&quot;</span><span class="p">)</span>
<span class="n">flights</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>dep_time</th>
      <th>sched_dep_time</th>
      <th>dep_delay</th>
      <th>arr_time</th>
      <th>sched_arr_time</th>
      <th>arr_delay</th>
      <th>carrier</th>
      <th>flight</th>
      <th>tailnum</th>
      <th>origin</th>
      <th>dest</th>
      <th>air_time</th>
      <th>distance</th>
      <th>hour</th>
      <th>minute</th>
      <th>time_hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>114018</th>
      <td>2013</td>
      <td>2</td>
      <td>4</td>
      <td>1032.0</td>
      <td>924.0</td>
      <td>68.0</td>
      <td>1222.0</td>
      <td>1118</td>
      <td>64.0</td>
      <td>EV</td>
      <td>4234</td>
      <td>N14148</td>
      <td>EWR</td>
      <td>STL</td>
      <td>153.0</td>
      <td>872</td>
      <td>9</td>
      <td>24</td>
      <td>2013-02-04 14:00:00+00:00</td>
    </tr>
    <tr>
      <th>314547</th>
      <td>2013</td>
      <td>9</td>
      <td>6</td>
      <td>1900.0</td>
      <td>1903.0</td>
      <td>-3.0</td>
      <td>2008.0</td>
      <td>2034</td>
      <td>-26.0</td>
      <td>EV</td>
      <td>4195</td>
      <td>N14125</td>
      <td>EWR</td>
      <td>BNA</td>
      <td>95.0</td>
      <td>748</td>
      <td>19</td>
      <td>3</td>
      <td>2013-09-06 23:00:00+00:00</td>
    </tr>
    <tr>
      <th>49815</th>
      <td>2013</td>
      <td>10</td>
      <td>25</td>
      <td>1108.0</td>
      <td>1115.0</td>
      <td>-7.0</td>
      <td>1241.0</td>
      <td>1300</td>
      <td>-19.0</td>
      <td>EV</td>
      <td>5273</td>
      <td>N615QX</td>
      <td>LGA</td>
      <td>PIT</td>
      <td>55.0</td>
      <td>335</td>
      <td>11</td>
      <td>15</td>
      <td>2013-10-25 15:00:00+00:00</td>
    </tr>
    <tr>
      <th>40120</th>
      <td>2013</td>
      <td>10</td>
      <td>15</td>
      <td>709.0</td>
      <td>710.0</td>
      <td>-1.0</td>
      <td>826.0</td>
      <td>845</td>
      <td>-19.0</td>
      <td>AA</td>
      <td>305</td>
      <td>N593AA</td>
      <td>LGA</td>
      <td>ORD</td>
      <td>109.0</td>
      <td>733</td>
      <td>7</td>
      <td>10</td>
      <td>2013-10-15 11:00:00+00:00</td>
    </tr>
    <tr>
      <th>37559</th>
      <td>2013</td>
      <td>10</td>
      <td>12</td>
      <td>758.0</td>
      <td>800.0</td>
      <td>-2.0</td>
      <td>1240.0</td>
      <td>1003</td>
      <td>NaN</td>
      <td>9E</td>
      <td>3353</td>
      <td>N925XJ</td>
      <td>JFK</td>
      <td>DTW</td>
      <td>NaN</td>
      <td>509</td>
      <td>8</td>
      <td>0</td>
      <td>2013-10-12 12:00:00+00:00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Flights that departed on January 1</span>
<span class="n">flights</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;month == 1 and day == 1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>dep_time</th>
      <th>sched_dep_time</th>
      <th>dep_delay</th>
      <th>arr_time</th>
      <th>sched_arr_time</th>
      <th>arr_delay</th>
      <th>carrier</th>
      <th>flight</th>
      <th>tailnum</th>
      <th>origin</th>
      <th>dest</th>
      <th>air_time</th>
      <th>distance</th>
      <th>hour</th>
      <th>minute</th>
      <th>time_hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>690</th>
      <td>2013</td>
      <td>1</td>
      <td>1</td>
      <td>1856.0</td>
      <td>1859.0</td>
      <td>-3.0</td>
      <td>2133.0</td>
      <td>2155</td>
      <td>-22.0</td>
      <td>B6</td>
      <td>155</td>
      <td>N505JB</td>
      <td>JFK</td>
      <td>MCO</td>
      <td>133.0</td>
      <td>944</td>
      <td>18</td>
      <td>59</td>
      <td>2013-01-01 23:00:00+00:00</td>
    </tr>
    <tr>
      <th>674</th>
      <td>2013</td>
      <td>1</td>
      <td>1</td>
      <td>1842.0</td>
      <td>1829.0</td>
      <td>13.0</td>
      <td>2144.0</td>
      <td>2136</td>
      <td>8.0</td>
      <td>UA</td>
      <td>1292</td>
      <td>N14214</td>
      <td>EWR</td>
      <td>FLL</td>
      <td>149.0</td>
      <td>1065</td>
      <td>18</td>
      <td>29</td>
      <td>2013-01-01 23:00:00+00:00</td>
    </tr>
    <tr>
      <th>605</th>
      <td>2013</td>
      <td>1</td>
      <td>1</td>
      <td>1729.0</td>
      <td>1718.0</td>
      <td>11.0</td>
      <td>2052.0</td>
      <td>2055</td>
      <td>-3.0</td>
      <td>UA</td>
      <td>1284</td>
      <td>N14120</td>
      <td>EWR</td>
      <td>SFO</td>
      <td>360.0</td>
      <td>2565</td>
      <td>17</td>
      <td>18</td>
      <td>2013-01-01 22:00:00+00:00</td>
    </tr>
    <tr>
      <th>660</th>
      <td>2013</td>
      <td>1</td>
      <td>1</td>
      <td>1826.0</td>
      <td>1830.0</td>
      <td>-4.0</td>
      <td>2154.0</td>
      <td>2207</td>
      <td>-13.0</td>
      <td>DL</td>
      <td>1643</td>
      <td>N3772H</td>
      <td>JFK</td>
      <td>SEA</td>
      <td>334.0</td>
      <td>2422</td>
      <td>18</td>
      <td>30</td>
      <td>2013-01-01 23:00:00+00:00</td>
    </tr>
    <tr>
      <th>269</th>
      <td>2013</td>
      <td>1</td>
      <td>1</td>
      <td>1120.0</td>
      <td>944.0</td>
      <td>96.0</td>
      <td>1331.0</td>
      <td>1213</td>
      <td>78.0</td>
      <td>EV</td>
      <td>4495</td>
      <td>N16561</td>
      <td>EWR</td>
      <td>SAV</td>
      <td>117.0</td>
      <td>708</td>
      <td>9</td>
      <td>44</td>
      <td>2013-01-01 14:00:00+00:00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>44</th>
      <td>2013</td>
      <td>1</td>
      <td>1</td>
      <td>639.0</td>
      <td>640.0</td>
      <td>-1.0</td>
      <td>739.0</td>
      <td>749</td>
      <td>-10.0</td>
      <td>B6</td>
      <td>1002</td>
      <td>N805JB</td>
      <td>JFK</td>
      <td>BOS</td>
      <td>41.0</td>
      <td>187</td>
      <td>6</td>
      <td>40</td>
      <td>2013-01-01 11:00:00+00:00</td>
    </tr>
    <tr>
      <th>127</th>
      <td>2013</td>
      <td>1</td>
      <td>1</td>
      <td>820.0</td>
      <td>820.0</td>
      <td>0.0</td>
      <td>1249.0</td>
      <td>1329</td>
      <td>-40.0</td>
      <td>DL</td>
      <td>301</td>
      <td>N900PC</td>
      <td>JFK</td>
      <td>SJU</td>
      <td>182.0</td>
      <td>1598</td>
      <td>8</td>
      <td>20</td>
      <td>2013-01-01 13:00:00+00:00</td>
    </tr>
    <tr>
      <th>156</th>
      <td>2013</td>
      <td>1</td>
      <td>1</td>
      <td>852.0</td>
      <td>855.0</td>
      <td>-3.0</td>
      <td>1046.0</td>
      <td>1020</td>
      <td>26.0</td>
      <td>WN</td>
      <td>3848</td>
      <td>N777QC</td>
      <td>EWR</td>
      <td>MDW</td>
      <td>146.0</td>
      <td>711</td>
      <td>8</td>
      <td>55</td>
      <td>2013-01-01 13:00:00+00:00</td>
    </tr>
    <tr>
      <th>32</th>
      <td>2013</td>
      <td>1</td>
      <td>1</td>
      <td>623.0</td>
      <td>627.0</td>
      <td>-4.0</td>
      <td>933.0</td>
      <td>932</td>
      <td>1.0</td>
      <td>UA</td>
      <td>496</td>
      <td>N459UA</td>
      <td>LGA</td>
      <td>IAH</td>
      <td>229.0</td>
      <td>1416</td>
      <td>6</td>
      <td>27</td>
      <td>2013-01-01 11:00:00+00:00</td>
    </tr>
    <tr>
      <th>595</th>
      <td>2013</td>
      <td>1</td>
      <td>1</td>
      <td>1717.0</td>
      <td>1720.0</td>
      <td>-3.0</td>
      <td>1920.0</td>
      <td>1910</td>
      <td>10.0</td>
      <td>AA</td>
      <td>345</td>
      <td>N539AA</td>
      <td>LGA</td>
      <td>ORD</td>
      <td>141.0</td>
      <td>733</td>
      <td>17</td>
      <td>20</td>
      <td>2013-01-01 22:00:00+00:00</td>
    </tr>
  </tbody>
</table>
<p>243 rows × 19 columns</p>
</div></div></div>
</div>
<p>Note that equality is tested by <code class="docutils literal notranslate"><span class="pre">==</span></code> and <em>not</em> by <code class="docutils literal notranslate"><span class="pre">=</span></code>, because the latter is used for assignment.</p>
<p><code class="docutils literal notranslate"><span class="pre">query</span></code> can also be used to pick out rows based on relationships between columns (we’ll use the penguins dataset to show this).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">penguins</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;penguins&quot;</span><span class="p">)</span>
<span class="n">penguins</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.1</td>
      <td>18.7</td>
      <td>181.0</td>
      <td>3750.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>39.5</td>
      <td>17.4</td>
      <td>186.0</td>
      <td>3800.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>40.3</td>
      <td>18.0</td>
      <td>195.0</td>
      <td>3250.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>36.7</td>
      <td>19.3</td>
      <td>193.0</td>
      <td>3450.0</td>
      <td>Female</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">penguins</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;bill_length_mm&lt;bill_depth_mm*1.8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>14</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>34.6</td>
      <td>21.1</td>
      <td>198.0</td>
      <td>4400.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>33.5</td>
      <td>19.0</td>
      <td>190.0</td>
      <td>3600.0</td>
      <td>Female</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Variables not in dataframes can be referenced with an <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> character like <code class="docutils literal notranslate"><span class="pre">&#64;a</span> <span class="pre">+</span> <span class="pre">b</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outside_var</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">penguins</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;bill_depth_mm &gt; @outside_var&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>38.6</td>
      <td>21.2</td>
      <td>191.0</td>
      <td>3800.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>34.6</td>
      <td>21.1</td>
      <td>198.0</td>
      <td>4400.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Adelie</td>
      <td>Torgersen</td>
      <td>46.0</td>
      <td>21.5</td>
      <td>194.0</td>
      <td>4200.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Adelie</td>
      <td>Dream</td>
      <td>39.2</td>
      <td>21.1</td>
      <td>196.0</td>
      <td>4150.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Adelie</td>
      <td>Dream</td>
      <td>42.3</td>
      <td>21.2</td>
      <td>191.0</td>
      <td>4150.0</td>
      <td>Male</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Adelie</td>
      <td>Biscoe</td>
      <td>41.3</td>
      <td>21.1</td>
      <td>195.0</td>
      <td>4400.0</td>
      <td>Male</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="re-arranging-rows">
<h3>Re-arranging Rows<a class="headerlink" href="#re-arranging-rows" title="Permalink to this headline">#</a></h3>
<p>Again and again, you will want to re-order the rows of your dataframe according to the values in a particular column. <strong>pandas</strong> makes this very easy via the <code class="docutils literal notranslate"><span class="pre">.sort_values</span></code> function. It takes a data frame and a set of column names to sort by. If you provide more than one column name, each additional column will be used to break ties in the values of preceding columns. For example, the following code sorts by the departure time, which is spread over four columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flights</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;day&quot;</span><span class="p">,</span> <span class="s2">&quot;dep_time&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>dep_time</th>
      <th>sched_dep_time</th>
      <th>dep_delay</th>
      <th>arr_time</th>
      <th>sched_arr_time</th>
      <th>arr_delay</th>
      <th>carrier</th>
      <th>flight</th>
      <th>tailnum</th>
      <th>origin</th>
      <th>dest</th>
      <th>air_time</th>
      <th>distance</th>
      <th>hour</th>
      <th>minute</th>
      <th>time_hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>2013</td>
      <td>1</td>
      <td>1</td>
      <td>542.0</td>
      <td>540.0</td>
      <td>2.0</td>
      <td>923.0</td>
      <td>850</td>
      <td>33.0</td>
      <td>AA</td>
      <td>1141</td>
      <td>N619AA</td>
      <td>JFK</td>
      <td>MIA</td>
      <td>160.0</td>
      <td>1089</td>
      <td>5</td>
      <td>40</td>
      <td>2013-01-01 10:00:00+00:00</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2013</td>
      <td>1</td>
      <td>1</td>
      <td>554.0</td>
      <td>558.0</td>
      <td>-4.0</td>
      <td>740.0</td>
      <td>728</td>
      <td>12.0</td>
      <td>UA</td>
      <td>1696</td>
      <td>N39463</td>
      <td>EWR</td>
      <td>ORD</td>
      <td>150.0</td>
      <td>719</td>
      <td>5</td>
      <td>58</td>
      <td>2013-01-01 10:00:00+00:00</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2013</td>
      <td>1</td>
      <td>1</td>
      <td>606.0</td>
      <td>610.0</td>
      <td>-4.0</td>
      <td>837.0</td>
      <td>845</td>
      <td>-8.0</td>
      <td>DL</td>
      <td>1743</td>
      <td>N3739P</td>
      <td>JFK</td>
      <td>ATL</td>
      <td>128.0</td>
      <td>760</td>
      <td>6</td>
      <td>10</td>
      <td>2013-01-01 11:00:00+00:00</td>
    </tr>
    <tr>
      <th>32</th>
      <td>2013</td>
      <td>1</td>
      <td>1</td>
      <td>623.0</td>
      <td>627.0</td>
      <td>-4.0</td>
      <td>933.0</td>
      <td>932</td>
      <td>1.0</td>
      <td>UA</td>
      <td>496</td>
      <td>N459UA</td>
      <td>LGA</td>
      <td>IAH</td>
      <td>229.0</td>
      <td>1416</td>
      <td>6</td>
      <td>27</td>
      <td>2013-01-01 11:00:00+00:00</td>
    </tr>
    <tr>
      <th>39</th>
      <td>2013</td>
      <td>1</td>
      <td>1</td>
      <td>629.0</td>
      <td>630.0</td>
      <td>-1.0</td>
      <td>721.0</td>
      <td>740</td>
      <td>-19.0</td>
      <td>WN</td>
      <td>4646</td>
      <td>N273WN</td>
      <td>LGA</td>
      <td>BWI</td>
      <td>40.0</td>
      <td>185</td>
      <td>6</td>
      <td>30</td>
      <td>2013-01-01 11:00:00+00:00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>111271</th>
      <td>2013</td>
      <td>12</td>
      <td>31</td>
      <td>2218.0</td>
      <td>2219.0</td>
      <td>-1.0</td>
      <td>315.0</td>
      <td>304</td>
      <td>11.0</td>
      <td>B6</td>
      <td>1203</td>
      <td>N625JB</td>
      <td>JFK</td>
      <td>SJU</td>
      <td>202.0</td>
      <td>1598</td>
      <td>22</td>
      <td>19</td>
      <td>2014-01-01 03:00:00+00:00</td>
    </tr>
    <tr>
      <th>111273</th>
      <td>2013</td>
      <td>12</td>
      <td>31</td>
      <td>2245.0</td>
      <td>2250.0</td>
      <td>-5.0</td>
      <td>2359.0</td>
      <td>2356</td>
      <td>3.0</td>
      <td>B6</td>
      <td>1816</td>
      <td>N318JB</td>
      <td>JFK</td>
      <td>SYR</td>
      <td>51.0</td>
      <td>209</td>
      <td>22</td>
      <td>50</td>
      <td>2014-01-01 03:00:00+00:00</td>
    </tr>
    <tr>
      <th>111291</th>
      <td>2013</td>
      <td>12</td>
      <td>31</td>
      <td>NaN</td>
      <td>705.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>931</td>
      <td>NaN</td>
      <td>UA</td>
      <td>1729</td>
      <td>NaN</td>
      <td>EWR</td>
      <td>DEN</td>
      <td>NaN</td>
      <td>1605</td>
      <td>7</td>
      <td>5</td>
      <td>2013-12-31 12:00:00+00:00</td>
    </tr>
    <tr>
      <th>111286</th>
      <td>2013</td>
      <td>12</td>
      <td>31</td>
      <td>NaN</td>
      <td>754.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1118</td>
      <td>NaN</td>
      <td>UA</td>
      <td>1455</td>
      <td>NaN</td>
      <td>EWR</td>
      <td>LAX</td>
      <td>NaN</td>
      <td>2454</td>
      <td>7</td>
      <td>54</td>
      <td>2013-12-31 12:00:00+00:00</td>
    </tr>
    <tr>
      <th>111292</th>
      <td>2013</td>
      <td>12</td>
      <td>31</td>
      <td>NaN</td>
      <td>825.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1029</td>
      <td>NaN</td>
      <td>US</td>
      <td>1831</td>
      <td>NaN</td>
      <td>JFK</td>
      <td>CLT</td>
      <td>NaN</td>
      <td>541</td>
      <td>8</td>
      <td>25</td>
      <td>2013-12-31 13:00:00+00:00</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 19 columns</p>
</div></div></div>
</div>
<p>You can use the keyword argument <code class="docutils literal notranslate"><span class="pre">ascending=False</span></code> to re-order by a column or columns in descending order.
For example, this code shows the most delayed flights:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flights</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;dep_delay&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>dep_time</th>
      <th>sched_dep_time</th>
      <th>dep_delay</th>
      <th>arr_time</th>
      <th>sched_arr_time</th>
      <th>arr_delay</th>
      <th>carrier</th>
      <th>flight</th>
      <th>tailnum</th>
      <th>origin</th>
      <th>dest</th>
      <th>air_time</th>
      <th>distance</th>
      <th>hour</th>
      <th>minute</th>
      <th>time_hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8239</th>
      <td>2013</td>
      <td>1</td>
      <td>10</td>
      <td>1121.0</td>
      <td>1635.0</td>
      <td>1126.0</td>
      <td>1239.0</td>
      <td>1810</td>
      <td>1109.0</td>
      <td>MQ</td>
      <td>3695</td>
      <td>N517MQ</td>
      <td>EWR</td>
      <td>ORD</td>
      <td>111.0</td>
      <td>719</td>
      <td>16</td>
      <td>35</td>
      <td>2013-01-10 21:00:00+00:00</td>
    </tr>
    <tr>
      <th>247040</th>
      <td>2013</td>
      <td>6</td>
      <td>27</td>
      <td>959.0</td>
      <td>1900.0</td>
      <td>899.0</td>
      <td>1236.0</td>
      <td>2226</td>
      <td>850.0</td>
      <td>DL</td>
      <td>2007</td>
      <td>N3762Y</td>
      <td>JFK</td>
      <td>PDX</td>
      <td>313.0</td>
      <td>2454</td>
      <td>19</td>
      <td>0</td>
      <td>2013-06-27 23:00:00+00:00</td>
    </tr>
    <tr>
      <th>270987</th>
      <td>2013</td>
      <td>7</td>
      <td>22</td>
      <td>2257.0</td>
      <td>759.0</td>
      <td>898.0</td>
      <td>121.0</td>
      <td>1026</td>
      <td>895.0</td>
      <td>DL</td>
      <td>2047</td>
      <td>N6716C</td>
      <td>LGA</td>
      <td>ATL</td>
      <td>109.0</td>
      <td>762</td>
      <td>7</td>
      <td>59</td>
      <td>2013-07-22 11:00:00+00:00</td>
    </tr>
    <tr>
      <th>195711</th>
      <td>2013</td>
      <td>5</td>
      <td>3</td>
      <td>1133.0</td>
      <td>2055.0</td>
      <td>878.0</td>
      <td>1250.0</td>
      <td>2215</td>
      <td>875.0</td>
      <td>MQ</td>
      <td>3744</td>
      <td>N523MQ</td>
      <td>EWR</td>
      <td>ORD</td>
      <td>112.0</td>
      <td>719</td>
      <td>20</td>
      <td>55</td>
      <td>2013-05-04 00:00:00+00:00</td>
    </tr>
    <tr>
      <th>119784</th>
      <td>2013</td>
      <td>2</td>
      <td>10</td>
      <td>2243.0</td>
      <td>830.0</td>
      <td>853.0</td>
      <td>100.0</td>
      <td>1106</td>
      <td>834.0</td>
      <td>F9</td>
      <td>835</td>
      <td>N203FR</td>
      <td>LGA</td>
      <td>DEN</td>
      <td>233.0</td>
      <td>1620</td>
      <td>8</td>
      <td>30</td>
      <td>2013-02-10 13:00:00+00:00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>174576</th>
      <td>2013</td>
      <td>4</td>
      <td>10</td>
      <td>NaN</td>
      <td>1935.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2113</td>
      <td>NaN</td>
      <td>9E</td>
      <td>4127</td>
      <td>NaN</td>
      <td>JFK</td>
      <td>IAD</td>
      <td>NaN</td>
      <td>228</td>
      <td>19</td>
      <td>35</td>
      <td>2013-04-10 23:00:00+00:00</td>
    </tr>
    <tr>
      <th>152951</th>
      <td>2013</td>
      <td>3</td>
      <td>18</td>
      <td>NaN</td>
      <td>2000.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2243</td>
      <td>NaN</td>
      <td>DL</td>
      <td>1147</td>
      <td>N648DL</td>
      <td>LGA</td>
      <td>ATL</td>
      <td>NaN</td>
      <td>762</td>
      <td>20</td>
      <td>0</td>
      <td>2013-03-19 00:00:00+00:00</td>
    </tr>
    <tr>
      <th>238050</th>
      <td>2013</td>
      <td>6</td>
      <td>17</td>
      <td>NaN</td>
      <td>709.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>942</td>
      <td>NaN</td>
      <td>UA</td>
      <td>318</td>
      <td>NaN</td>
      <td>LGA</td>
      <td>IAH</td>
      <td>NaN</td>
      <td>1416</td>
      <td>7</td>
      <td>9</td>
      <td>2013-06-17 11:00:00+00:00</td>
    </tr>
    <tr>
      <th>25985</th>
      <td>2013</td>
      <td>1</td>
      <td>30</td>
      <td>NaN</td>
      <td>1555.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1810</td>
      <td>NaN</td>
      <td>EV</td>
      <td>3820</td>
      <td>N12563</td>
      <td>EWR</td>
      <td>SDF</td>
      <td>NaN</td>
      <td>642</td>
      <td>15</td>
      <td>55</td>
      <td>2013-01-30 20:00:00+00:00</td>
    </tr>
    <tr>
      <th>223861</th>
      <td>2013</td>
      <td>6</td>
      <td>2</td>
      <td>NaN</td>
      <td>1500.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1722</td>
      <td>NaN</td>
      <td>EV</td>
      <td>4971</td>
      <td>N600QX</td>
      <td>LGA</td>
      <td>CHS</td>
      <td>NaN</td>
      <td>641</td>
      <td>15</td>
      <td>0</td>
      <td>2013-06-02 19:00:00+00:00</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 19 columns</p>
</div></div></div>
</div>
<p>You can of course combine all of the above row manipulations to solve more complex problems.
For example, we could look for the top three destinations of the flights that were most delayed on arrival that left on roughly on time:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">flights</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;dep_delay &lt;= 10 and dep_delay &gt;= -10&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;arr_delay&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>dep_time</th>
      <th>sched_dep_time</th>
      <th>dep_delay</th>
      <th>arr_time</th>
      <th>sched_arr_time</th>
      <th>arr_delay</th>
      <th>carrier</th>
      <th>flight</th>
      <th>tailnum</th>
      <th>origin</th>
      <th>dest</th>
      <th>air_time</th>
      <th>distance</th>
      <th>hour</th>
      <th>minute</th>
      <th>time_hour</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>55985</th>
      <td>2013</td>
      <td>11</td>
      <td>1</td>
      <td>658.0</td>
      <td>700.0</td>
      <td>-2.0</td>
      <td>1329.0</td>
      <td>1015</td>
      <td>194.0</td>
      <td>VX</td>
      <td>399</td>
      <td>N629VA</td>
      <td>JFK</td>
      <td>LAX</td>
      <td>336.0</td>
      <td>2475</td>
      <td>7</td>
      <td>0</td>
      <td>2013-11-01 11:00:00+00:00</td>
    </tr>
    <tr>
      <th>181270</th>
      <td>2013</td>
      <td>4</td>
      <td>18</td>
      <td>558.0</td>
      <td>600.0</td>
      <td>-2.0</td>
      <td>1149.0</td>
      <td>850</td>
      <td>179.0</td>
      <td>AA</td>
      <td>707</td>
      <td>N3EXAA</td>
      <td>LGA</td>
      <td>DFW</td>
      <td>234.0</td>
      <td>1389</td>
      <td>6</td>
      <td>0</td>
      <td>2013-04-18 10:00:00+00:00</td>
    </tr>
    <tr>
      <th>256340</th>
      <td>2013</td>
      <td>7</td>
      <td>7</td>
      <td>1659.0</td>
      <td>1700.0</td>
      <td>-1.0</td>
      <td>2050.0</td>
      <td>1823</td>
      <td>147.0</td>
      <td>US</td>
      <td>2183</td>
      <td>N948UW</td>
      <td>LGA</td>
      <td>DCA</td>
      <td>64.0</td>
      <td>214</td>
      <td>17</td>
      <td>0</td>
      <td>2013-07-07 21:00:00+00:00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="exercises">
<h3>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">#</a></h3>
<ol>
<li><p>Find all flights that</p>
<p>a. Had an arrival delay of two or more hours</p>
<p>b. Flew to Houston (<code class="docutils literal notranslate"><span class="pre">&quot;IAH&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;HOU&quot;</span></code>)</p>
<p>c. Were operated by United, American, or Delta</p>
<p>d. Departed in summer (July, August, and September)</p>
<p>e. Arrived more than two hours late, but didn’t leave late</p>
<p>f. Were delayed by at least an hour, but made up over 30 minutes in flight</p>
</li>
<li><p>Sort <code class="docutils literal notranslate"><span class="pre">flights</span></code> to find the flights with longest departure delays.</p></li>
<li><p>Sort <code class="docutils literal notranslate"><span class="pre">flights</span></code> to find the fastest flights</p></li>
<li><p>Which flights traveled the farthest?</p></li>
<li><p>Does it matter what order you used <code class="docutils literal notranslate"><span class="pre">query()</span></code> and <code class="docutils literal notranslate"><span class="pre">sort_values()</span></code> in if you’re using both? Why/why not? Think about the results and how much work the functions would have to do.</p></li>
</ol>
</section>
</section>
<section id="manipulating-columns">
<h2>Manipulating Columns<a class="headerlink" href="#manipulating-columns" title="Permalink to this headline">#</a></h2>
<p>Now you know how to put data in a dataframe, how do you access the bits of it you need? There are various ways and in this section, we’ll look at ways to access columns and perform operations on them.</p>
<p><img alt="Depiction of selecting some columns" src="https://pandas.pydata.org/docs/_images/03_subset_columns.svg" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some <strong>pandas</strong> operations can apply either to columns or rows, depending on the syntax used. For example, accessing values by position can be achieved in the same way for rows and columns via <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> where to access the ith row you would use <code class="docutils literal notranslate"><span class="pre">df.iloc[i]</span></code> and to access the jth column you would use <code class="docutils literal notranslate"><span class="pre">df.iloc[:,</span> <span class="pre">j]</span></code> where <code class="docutils literal notranslate"><span class="pre">:</span></code> stands in for ‘any row’.</p>
</div>
<section id="creating-new-columns">
<h3>Creating New Columns<a class="headerlink" href="#creating-new-columns" title="Permalink to this headline">#</a></h3>
<p>Columns and rows in dataframes can undergo all the usual arithmetic operations you’d expect of addition, multiplication, division, and so on. If the underlying datatypes of two columns have a group operation, then the dataframe columns will use that.</p>
<p><img alt="" src="https://github.com/pandas-dev/pandas/raw/059c8bac51e47d6eaaa3e36d6a293a22312925e6/doc/source/_static/schemas/05_newcolumn_1.svg" /></p>
<p>Let’s now move on to creating new columns, either using new information or from existing columns. Given a dataframe, <code class="docutils literal notranslate"><span class="pre">df</span></code>, creating a new column with the same value repeated is as easy as using square brackets with a string (text enclosed by quotation marks) in.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;new_column0&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col0</th>
      <th>col1</th>
      <th>col2</th>
      <th>col3</th>
      <th>col4</th>
      <th>col5</th>
      <th>col6</th>
      <th>new_column0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>apple</td>
      <td>5</td>
    </tr>
    <tr>
      <th>b</th>
      <td>6.0</td>
      <td>7.0</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>11.0</td>
      <td>orange</td>
      <td>5</td>
    </tr>
    <tr>
      <th>c</th>
      <td>12.0</td>
      <td>13.0</td>
      <td>14.0</td>
      <td>15.0</td>
      <td>16.0</td>
      <td>17.0</td>
      <td>pineapple</td>
      <td>5</td>
    </tr>
    <tr>
      <th>d</th>
      <td>18.0</td>
      <td>19.0</td>
      <td>20.0</td>
      <td>21.0</td>
      <td>22.0</td>
      <td>23.0</td>
      <td>mango</td>
      <td>5</td>
    </tr>
    <tr>
      <th>e</th>
      <td>24.0</td>
      <td>25.0</td>
      <td>26.0</td>
      <td>27.0</td>
      <td>28.0</td>
      <td>29.0</td>
      <td>kiwi</td>
      <td>5</td>
    </tr>
    <tr>
      <th>f</th>
      <td>30.0</td>
      <td>31.0</td>
      <td>32.0</td>
      <td>33.0</td>
      <td>34.0</td>
      <td>35.0</td>
      <td>lemon</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If we do the same operation again, but with a different right-hand side, it will overwrite what was already in that column. Let’s see this with an example where we put different values in each position by assigning a list to the new column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;new_column0&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col0</th>
      <th>col1</th>
      <th>col2</th>
      <th>col3</th>
      <th>col4</th>
      <th>col5</th>
      <th>col6</th>
      <th>new_column0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>apple</td>
      <td>0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>6.0</td>
      <td>7.0</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>11.0</td>
      <td>orange</td>
      <td>1</td>
    </tr>
    <tr>
      <th>c</th>
      <td>12.0</td>
      <td>13.0</td>
      <td>14.0</td>
      <td>15.0</td>
      <td>16.0</td>
      <td>17.0</td>
      <td>pineapple</td>
      <td>2</td>
    </tr>
    <tr>
      <th>d</th>
      <td>18.0</td>
      <td>19.0</td>
      <td>20.0</td>
      <td>21.0</td>
      <td>22.0</td>
      <td>23.0</td>
      <td>mango</td>
      <td>3</td>
    </tr>
    <tr>
      <th>e</th>
      <td>24.0</td>
      <td>25.0</td>
      <td>26.0</td>
      <td>27.0</td>
      <td>28.0</td>
      <td>29.0</td>
      <td>kiwi</td>
      <td>4</td>
    </tr>
    <tr>
      <th>f</th>
      <td>30.0</td>
      <td>31.0</td>
      <td>32.0</td>
      <td>33.0</td>
      <td>34.0</td>
      <td>35.0</td>
      <td>lemon</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>What happens if you try to use assignment where the right-hand side values are longer or shorter than the length of the data frame?</p>
</div>
<p>By passing a list within the square brackets, we can actually create more than one new column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;new_column1&quot;</span><span class="p">,</span> <span class="s2">&quot;new_column2&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col0</th>
      <th>col1</th>
      <th>col2</th>
      <th>col3</th>
      <th>col4</th>
      <th>col5</th>
      <th>col6</th>
      <th>new_column0</th>
      <th>new_column1</th>
      <th>new_column2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>apple</td>
      <td>0</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>b</th>
      <td>6.0</td>
      <td>7.0</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>11.0</td>
      <td>orange</td>
      <td>1</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>c</th>
      <td>12.0</td>
      <td>13.0</td>
      <td>14.0</td>
      <td>15.0</td>
      <td>16.0</td>
      <td>17.0</td>
      <td>pineapple</td>
      <td>2</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>d</th>
      <td>18.0</td>
      <td>19.0</td>
      <td>20.0</td>
      <td>21.0</td>
      <td>22.0</td>
      <td>23.0</td>
      <td>mango</td>
      <td>3</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>e</th>
      <td>24.0</td>
      <td>25.0</td>
      <td>26.0</td>
      <td>27.0</td>
      <td>28.0</td>
      <td>29.0</td>
      <td>kiwi</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>f</th>
      <td>30.0</td>
      <td>31.0</td>
      <td>32.0</td>
      <td>33.0</td>
      <td>34.0</td>
      <td>35.0</td>
      <td>lemon</td>
      <td>5</td>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Very often, you will want to create a new column that is the result of an operation on existing columns. There are a couple of ways to do this. The ‘stand-alone’ method works in a similar way to what we’ve just seen except that we refer to the dataframe on the right-hand side of the assignment statement too:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;new_column3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;col0&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;new_column0&quot;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col0</th>
      <th>col1</th>
      <th>col2</th>
      <th>col3</th>
      <th>col4</th>
      <th>col5</th>
      <th>col6</th>
      <th>new_column0</th>
      <th>new_column1</th>
      <th>new_column2</th>
      <th>new_column3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>apple</td>
      <td>0</td>
      <td>5</td>
      <td>6</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>6.0</td>
      <td>7.0</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>11.0</td>
      <td>orange</td>
      <td>1</td>
      <td>5</td>
      <td>6</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>12.0</td>
      <td>13.0</td>
      <td>14.0</td>
      <td>15.0</td>
      <td>16.0</td>
      <td>17.0</td>
      <td>pineapple</td>
      <td>2</td>
      <td>5</td>
      <td>6</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>d</th>
      <td>18.0</td>
      <td>19.0</td>
      <td>20.0</td>
      <td>21.0</td>
      <td>22.0</td>
      <td>23.0</td>
      <td>mango</td>
      <td>3</td>
      <td>5</td>
      <td>6</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>24.0</td>
      <td>25.0</td>
      <td>26.0</td>
      <td>27.0</td>
      <td>28.0</td>
      <td>29.0</td>
      <td>kiwi</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>f</th>
      <td>30.0</td>
      <td>31.0</td>
      <td>32.0</td>
      <td>33.0</td>
      <td>34.0</td>
      <td>35.0</td>
      <td>lemon</td>
      <td>5</td>
      <td>5</td>
      <td>6</td>
      <td>25.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>#### Assign</p>
<p>The other way to do this involves an ‘assign’ statement and is used when you wish to chain multiple steps together. These use a special syntax called a ‘lambda’ statement, which (here at least) just provides a way of specifying to <strong>pandas</strong> that we wish to perform the operation on every row. Below is an example using the flights data. You should note though that the word ‘row’ below is a dummy; you could replace it with any variable name (for example, <code class="docutils literal notranslate"><span class="pre">x</span></code>) but <code class="docutils literal notranslate"><span class="pre">row</span></code> makes what is happening a little bit clearer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">flights</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">gain</span><span class="o">=</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;dep_delay&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;arr_delay&quot;</span><span class="p">],</span>
        <span class="n">speed</span><span class="o">=</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;distance&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;air_time&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">60</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>dep_time</th>
      <th>sched_dep_time</th>
      <th>dep_delay</th>
      <th>arr_time</th>
      <th>sched_arr_time</th>
      <th>arr_delay</th>
      <th>carrier</th>
      <th>...</th>
      <th>tailnum</th>
      <th>origin</th>
      <th>dest</th>
      <th>air_time</th>
      <th>distance</th>
      <th>hour</th>
      <th>minute</th>
      <th>time_hour</th>
      <th>gain</th>
      <th>speed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>114018</th>
      <td>2013</td>
      <td>2</td>
      <td>4</td>
      <td>1032.0</td>
      <td>924.0</td>
      <td>68.0</td>
      <td>1222.0</td>
      <td>1118</td>
      <td>64.0</td>
      <td>EV</td>
      <td>...</td>
      <td>N14148</td>
      <td>EWR</td>
      <td>STL</td>
      <td>153.0</td>
      <td>872</td>
      <td>9</td>
      <td>24</td>
      <td>2013-02-04 14:00:00+00:00</td>
      <td>4.0</td>
      <td>341.960784</td>
    </tr>
    <tr>
      <th>314547</th>
      <td>2013</td>
      <td>9</td>
      <td>6</td>
      <td>1900.0</td>
      <td>1903.0</td>
      <td>-3.0</td>
      <td>2008.0</td>
      <td>2034</td>
      <td>-26.0</td>
      <td>EV</td>
      <td>...</td>
      <td>N14125</td>
      <td>EWR</td>
      <td>BNA</td>
      <td>95.0</td>
      <td>748</td>
      <td>19</td>
      <td>3</td>
      <td>2013-09-06 23:00:00+00:00</td>
      <td>23.0</td>
      <td>472.421053</td>
    </tr>
    <tr>
      <th>49815</th>
      <td>2013</td>
      <td>10</td>
      <td>25</td>
      <td>1108.0</td>
      <td>1115.0</td>
      <td>-7.0</td>
      <td>1241.0</td>
      <td>1300</td>
      <td>-19.0</td>
      <td>EV</td>
      <td>...</td>
      <td>N615QX</td>
      <td>LGA</td>
      <td>PIT</td>
      <td>55.0</td>
      <td>335</td>
      <td>11</td>
      <td>15</td>
      <td>2013-10-25 15:00:00+00:00</td>
      <td>12.0</td>
      <td>365.454545</td>
    </tr>
    <tr>
      <th>40120</th>
      <td>2013</td>
      <td>10</td>
      <td>15</td>
      <td>709.0</td>
      <td>710.0</td>
      <td>-1.0</td>
      <td>826.0</td>
      <td>845</td>
      <td>-19.0</td>
      <td>AA</td>
      <td>...</td>
      <td>N593AA</td>
      <td>LGA</td>
      <td>ORD</td>
      <td>109.0</td>
      <td>733</td>
      <td>7</td>
      <td>10</td>
      <td>2013-10-15 11:00:00+00:00</td>
      <td>18.0</td>
      <td>403.486239</td>
    </tr>
    <tr>
      <th>37559</th>
      <td>2013</td>
      <td>10</td>
      <td>12</td>
      <td>758.0</td>
      <td>800.0</td>
      <td>-2.0</td>
      <td>1240.0</td>
      <td>1003</td>
      <td>NaN</td>
      <td>9E</td>
      <td>...</td>
      <td>N925XJ</td>
      <td>JFK</td>
      <td>DTW</td>
      <td>NaN</td>
      <td>509</td>
      <td>8</td>
      <td>0</td>
      <td>2013-10-12 12:00:00+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>276666</th>
      <td>2013</td>
      <td>7</td>
      <td>28</td>
      <td>1949.0</td>
      <td>1722.0</td>
      <td>147.0</td>
      <td>2137.0</td>
      <td>1847</td>
      <td>170.0</td>
      <td>EV</td>
      <td>...</td>
      <td>N29917</td>
      <td>EWR</td>
      <td>BNA</td>
      <td>116.0</td>
      <td>748</td>
      <td>17</td>
      <td>22</td>
      <td>2013-07-28 21:00:00+00:00</td>
      <td>-23.0</td>
      <td>386.896552</td>
    </tr>
    <tr>
      <th>25985</th>
      <td>2013</td>
      <td>1</td>
      <td>30</td>
      <td>NaN</td>
      <td>1555.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1810</td>
      <td>NaN</td>
      <td>EV</td>
      <td>...</td>
      <td>N12563</td>
      <td>EWR</td>
      <td>SDF</td>
      <td>NaN</td>
      <td>642</td>
      <td>15</td>
      <td>55</td>
      <td>2013-01-30 20:00:00+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>223861</th>
      <td>2013</td>
      <td>6</td>
      <td>2</td>
      <td>NaN</td>
      <td>1500.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1722</td>
      <td>NaN</td>
      <td>EV</td>
      <td>...</td>
      <td>N600QX</td>
      <td>LGA</td>
      <td>CHS</td>
      <td>NaN</td>
      <td>641</td>
      <td>15</td>
      <td>0</td>
      <td>2013-06-02 19:00:00+00:00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>42138</th>
      <td>2013</td>
      <td>10</td>
      <td>17</td>
      <td>821.0</td>
      <td>825.0</td>
      <td>-4.0</td>
      <td>1136.0</td>
      <td>1148</td>
      <td>-12.0</td>
      <td>UA</td>
      <td>...</td>
      <td>N554UA</td>
      <td>JFK</td>
      <td>SFO</td>
      <td>336.0</td>
      <td>2586</td>
      <td>8</td>
      <td>25</td>
      <td>2013-10-17 12:00:00+00:00</td>
      <td>8.0</td>
      <td>461.785714</td>
    </tr>
    <tr>
      <th>50760</th>
      <td>2013</td>
      <td>10</td>
      <td>26</td>
      <td>1215.0</td>
      <td>1200.0</td>
      <td>15.0</td>
      <td>1325.0</td>
      <td>1312</td>
      <td>13.0</td>
      <td>DL</td>
      <td>...</td>
      <td>N648DL</td>
      <td>JFK</td>
      <td>BOS</td>
      <td>40.0</td>
      <td>187</td>
      <td>12</td>
      <td>0</td>
      <td>2013-10-26 16:00:00+00:00</td>
      <td>2.0</td>
      <td>280.500000</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 21 columns</p>
</div></div></div>
</div>
<p>You’ll have seen there’s a <code class="docutils literal notranslate"><span class="pre">lambda</span></code> keyword in the above. Lambda (or anonymous) functions have a rich history in mathematics, and were used by scientists such as Church and Turing to create proofs about what is computable <em>before electronic computers existed</em>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A lambda function is like any normal function in Python except that it has no name, and it tends to be contained in one line of code. A lambda function is made of an argument, a colon, and an expression, like the following lambda function that multiplies an input by three.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="mi">3</span>
</pre></div>
</div>
</div>
<p>They can be used to define compact functions, for example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multiply_plus_one</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">multiply_plus_one</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13
</pre></div>
</div>
</div>
</div>
<p>The main way that you’ll use them is in <strong>pandas</strong> dataframes.</p>
</section>
<section id="accessing-columns">
<h3>Accessing Columns<a class="headerlink" href="#accessing-columns" title="Permalink to this headline">#</a></h3>
<p>Just as with selecting rows, there are many options and ways to select the columns to operate on. The one with the simplest syntax is the name of the data frame followed by square brackets and the column name (as a string)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;col0&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a     0.0
b     6.0
c    12.0
d    18.0
e    24.0
f    30.0
Name: col0, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>If you need to select <em>multiple</em> columns, you cannot just pass a string into <code class="docutils literal notranslate"><span class="pre">df[...]</span></code>; instead you need to pass an object that is iterable (and so has multiple items). The most straight forward way to select multiple columns is to pass a <em>list</em>. Remember, lists comes in square brackets so we’re going to see something with repeated square brackets: one for accessing the data frame’s innards and one for the list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;col0&quot;</span><span class="p">,</span> <span class="s2">&quot;new_column0&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col0</th>
      <th>new_column0</th>
      <th>col2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.0</td>
      <td>0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>6.0</td>
      <td>1</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>12.0</td>
      <td>2</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>d</th>
      <td>18.0</td>
      <td>3</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>24.0</td>
      <td>4</td>
      <td>26.0</td>
    </tr>
    <tr>
      <th>f</th>
      <td>30.0</td>
      <td>5</td>
      <td>32.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If you want to access particular rows at the same time, use the <code class="docutils literal notranslate"><span class="pre">.loc</span></code> access function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;col0&quot;</span><span class="p">,</span> <span class="s2">&quot;new_column0&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col0</th>
      <th>new_column0</th>
      <th>col2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.0</td>
      <td>0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>6.0</td>
      <td>1</td>
      <td>8.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>And, just as with rows, we can access columns by their position using <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> (where <code class="docutils literal notranslate"><span class="pre">:</span></code> stands in for ‘any row’).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col0</th>
      <th>col1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>6.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>12.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>d</th>
      <td>18.0</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>24.0</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>f</th>
      <td>30.0</td>
      <td>31.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Sometimes, you’ll want to select columns based on the <em>type</em> of data that they hold. For this, <strong>pandas</strong> provides a function <code class="docutils literal notranslate"><span class="pre">.select_dtypes</span></code>. Let’s use this to select all columns with integers in the flights data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flights</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>sched_arr_time</th>
      <th>flight</th>
      <th>distance</th>
      <th>hour</th>
      <th>minute</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>114018</th>
      <td>2013</td>
      <td>2</td>
      <td>4</td>
      <td>1118</td>
      <td>4234</td>
      <td>872</td>
      <td>9</td>
      <td>24</td>
    </tr>
    <tr>
      <th>314547</th>
      <td>2013</td>
      <td>9</td>
      <td>6</td>
      <td>2034</td>
      <td>4195</td>
      <td>748</td>
      <td>19</td>
      <td>3</td>
    </tr>
    <tr>
      <th>49815</th>
      <td>2013</td>
      <td>10</td>
      <td>25</td>
      <td>1300</td>
      <td>5273</td>
      <td>335</td>
      <td>11</td>
      <td>15</td>
    </tr>
    <tr>
      <th>40120</th>
      <td>2013</td>
      <td>10</td>
      <td>15</td>
      <td>845</td>
      <td>305</td>
      <td>733</td>
      <td>7</td>
      <td>10</td>
    </tr>
    <tr>
      <th>37559</th>
      <td>2013</td>
      <td>10</td>
      <td>12</td>
      <td>1003</td>
      <td>3353</td>
      <td>509</td>
      <td>8</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>276666</th>
      <td>2013</td>
      <td>7</td>
      <td>28</td>
      <td>1847</td>
      <td>4187</td>
      <td>748</td>
      <td>17</td>
      <td>22</td>
    </tr>
    <tr>
      <th>25985</th>
      <td>2013</td>
      <td>1</td>
      <td>30</td>
      <td>1810</td>
      <td>3820</td>
      <td>642</td>
      <td>15</td>
      <td>55</td>
    </tr>
    <tr>
      <th>223861</th>
      <td>2013</td>
      <td>6</td>
      <td>2</td>
      <td>1722</td>
      <td>4971</td>
      <td>641</td>
      <td>15</td>
      <td>0</td>
    </tr>
    <tr>
      <th>42138</th>
      <td>2013</td>
      <td>10</td>
      <td>17</td>
      <td>1148</td>
      <td>397</td>
      <td>2586</td>
      <td>8</td>
      <td>25</td>
    </tr>
    <tr>
      <th>50760</th>
      <td>2013</td>
      <td>10</td>
      <td>26</td>
      <td>1312</td>
      <td>2451</td>
      <td>187</td>
      <td>12</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 8 columns</p>
</div></div></div>
</div>
<p>There are other occassions when you’d like to select columns based on criteria such as patterns in the <em>name</em> of the column. Because Python has very good support for text, this is very possible but doesn’t tend to be so built-in to <strong>pandas</strong> functions. The trick is to generate a list of column names that you want from the pattern you’re interested in.</p>
<p>Let’s see a couple of examples. First, let’s get all columns in our <code class="docutils literal notranslate"><span class="pre">df</span></code> data frame that begin with <code class="docutils literal notranslate"><span class="pre">&quot;new_...&quot;</span></code>. We’ll generate a list of true and false values reflecting if each of the columns begins with “new” and then we’ll pass those true and false values to <code class="docutils literal notranslate"><span class="pre">.loc</span></code>, which will only give columns for which the result was <code class="docutils literal notranslate"><span class="pre">True</span></code>. To show what’s going on, we’ll break it into two steps:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The list of columns:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The list of true and false values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;new&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The selection from the data frame:&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;new&quot;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The list of columns:
Index([&#39;col0&#39;, &#39;col1&#39;, &#39;col2&#39;, &#39;col3&#39;, &#39;col4&#39;, &#39;col5&#39;, &#39;col6&#39;, &#39;new_column0&#39;,
       &#39;new_column1&#39;, &#39;new_column2&#39;, &#39;new_column3&#39;],
      dtype=&#39;object&#39;)


The list of true and false values:
[False False False False False False False  True  True  True  True]


The selection from the data frame:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>new_column0</th>
      <th>new_column1</th>
      <th>new_column2</th>
      <th>new_column3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0</td>
      <td>5</td>
      <td>6</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>1</td>
      <td>5</td>
      <td>6</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>2</td>
      <td>5</td>
      <td>6</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>d</th>
      <td>3</td>
      <td>5</td>
      <td>6</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>f</th>
      <td>5</td>
      <td>5</td>
      <td>6</td>
      <td>25.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As well as <code class="docutils literal notranslate"><span class="pre">startswith</span></code>, there are other commands like <code class="docutils literal notranslate"><span class="pre">endswith</span></code>, <code class="docutils literal notranslate"><span class="pre">contains</span></code>, <code class="docutils literal notranslate"><span class="pre">isnumeric</span></code>, and <code class="docutils literal notranslate"><span class="pre">islower</span></code>.</p>
<section id="eval">
<h4>Eval<a class="headerlink" href="#eval" title="Permalink to this headline">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">eval</span></code> evaluates a string describing operations on DataFrame columns to create new columns. It operates on columns only, not rows or elements. Let’s see an example of it applied to the <code class="docutils literal notranslate"><span class="pre">penguins</span></code> dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">penguins</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s2">&quot;bill_length_mm / bill_depth_mm&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    2.090909
1    2.270115
2    2.238889
3         NaN
4    1.901554
dtype: float64
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">eval</span></code> is especially useful for filtering by multiple columns at once. In the example below, <code class="docutils literal notranslate"><span class="pre">eval</span></code> is first used to create a new boolean series (but does not add it to the dataframe) and it is this boolean series that then filters the dataframe down to a small number of rows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eval_string</span> <span class="o">=</span> <span class="s2">&quot;species == &#39;Gentoo&#39; &amp; island == &#39;Biscoe&#39; &amp; sex == &#39;Female&#39;&quot;</span>
<span class="n">penguins</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">penguins</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">eval_string</span><span class="p">),</span> <span class="p">:]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>species</th>
      <th>island</th>
      <th>bill_length_mm</th>
      <th>bill_depth_mm</th>
      <th>flipper_length_mm</th>
      <th>body_mass_g</th>
      <th>sex</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>220</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>46.1</td>
      <td>13.2</td>
      <td>211.0</td>
      <td>4500.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>222</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>48.7</td>
      <td>14.1</td>
      <td>210.0</td>
      <td>4450.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>225</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>46.5</td>
      <td>13.5</td>
      <td>210.0</td>
      <td>4550.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>226</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>45.4</td>
      <td>14.6</td>
      <td>211.0</td>
      <td>4800.0</td>
      <td>Female</td>
    </tr>
    <tr>
      <th>228</th>
      <td>Gentoo</td>
      <td>Biscoe</td>
      <td>43.3</td>
      <td>13.4</td>
      <td>209.0</td>
      <td>4400.0</td>
      <td>Female</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="renaming-columns">
<h3>Renaming Columns<a class="headerlink" href="#renaming-columns" title="Permalink to this headline">#</a></h3>
<p>There are three easy ways to rename columns, depending on what the context is. The first is to use the dedicated <code class="docutils literal notranslate"><span class="pre">rename</span></code> function with an object called a dictionary. Dictionaries in Python consist of curly brackets with comma separated pairs of values where the first values maps into the second value. An example of a dictionary would be <code class="docutils literal notranslate"><span class="pre">{'old_col1':</span> <span class="pre">'new_col1',</span> <span class="pre">'old_col2':</span> <span class="pre">'new_col2'}</span></code>. Let’s see this in practice (but note that we are not ‘saving’ the resulting data frame, just showing it—to save it, you’d need to add <code class="docutils literal notranslate"><span class="pre">df</span> <span class="pre">=</span> </code> to the left-hand side of the code below).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;col3&quot;</span><span class="p">:</span> <span class="s2">&quot;letters&quot;</span><span class="p">,</span> <span class="s2">&quot;col4&quot;</span><span class="p">:</span> <span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="s2">&quot;col6&quot;</span><span class="p">:</span> <span class="s2">&quot;fruit&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col0</th>
      <th>col1</th>
      <th>col2</th>
      <th>letters</th>
      <th>names</th>
      <th>col5</th>
      <th>fruit</th>
      <th>new_column0</th>
      <th>new_column1</th>
      <th>new_column2</th>
      <th>new_column3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>apple</td>
      <td>0</td>
      <td>5</td>
      <td>6</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>6.0</td>
      <td>7.0</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>11.0</td>
      <td>orange</td>
      <td>1</td>
      <td>5</td>
      <td>6</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>12.0</td>
      <td>13.0</td>
      <td>14.0</td>
      <td>15.0</td>
      <td>16.0</td>
      <td>17.0</td>
      <td>pineapple</td>
      <td>2</td>
      <td>5</td>
      <td>6</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>d</th>
      <td>18.0</td>
      <td>19.0</td>
      <td>20.0</td>
      <td>21.0</td>
      <td>22.0</td>
      <td>23.0</td>
      <td>mango</td>
      <td>3</td>
      <td>5</td>
      <td>6</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>24.0</td>
      <td>25.0</td>
      <td>26.0</td>
      <td>27.0</td>
      <td>28.0</td>
      <td>29.0</td>
      <td>kiwi</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>f</th>
      <td>30.0</td>
      <td>31.0</td>
      <td>32.0</td>
      <td>33.0</td>
      <td>34.0</td>
      <td>35.0</td>
      <td>lemon</td>
      <td>5</td>
      <td>5</td>
      <td>6</td>
      <td>25.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The second method is for when you want to rename all of the columns. For that you simply set <code class="docutils literal notranslate"><span class="pre">df.columns</span></code> equal to the new set of columns that you’d like to have. For example, we might want to capitalise the first letter of each column using <code class="docutils literal notranslate"><span class="pre">str.capitalize()</span></code> and assign that to <code class="docutils literal notranslate"><span class="pre">df.columns</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Col0</th>
      <th>Col1</th>
      <th>Col2</th>
      <th>Col3</th>
      <th>Col4</th>
      <th>Col5</th>
      <th>Col6</th>
      <th>New_column0</th>
      <th>New_column1</th>
      <th>New_column2</th>
      <th>New_column3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>apple</td>
      <td>0</td>
      <td>5</td>
      <td>6</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>6.0</td>
      <td>7.0</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>11.0</td>
      <td>orange</td>
      <td>1</td>
      <td>5</td>
      <td>6</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>12.0</td>
      <td>13.0</td>
      <td>14.0</td>
      <td>15.0</td>
      <td>16.0</td>
      <td>17.0</td>
      <td>pineapple</td>
      <td>2</td>
      <td>5</td>
      <td>6</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>d</th>
      <td>18.0</td>
      <td>19.0</td>
      <td>20.0</td>
      <td>21.0</td>
      <td>22.0</td>
      <td>23.0</td>
      <td>mango</td>
      <td>3</td>
      <td>5</td>
      <td>6</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>24.0</td>
      <td>25.0</td>
      <td>26.0</td>
      <td>27.0</td>
      <td>28.0</td>
      <td>29.0</td>
      <td>kiwi</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>f</th>
      <td>30.0</td>
      <td>31.0</td>
      <td>32.0</td>
      <td>33.0</td>
      <td>34.0</td>
      <td>35.0</td>
      <td>lemon</td>
      <td>5</td>
      <td>5</td>
      <td>6</td>
      <td>25.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Finally, we might be interested in just replacing specific parts of column names. In this case, we can use <code class="docutils literal notranslate"><span class="pre">.str.replace</span></code>. As an example, let’s add the word <code class="docutils literal notranslate"><span class="pre">&quot;Original&quot;</span></code> ahead of the original columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Col&quot;</span><span class="p">,</span> <span class="s2">&quot;Original_column&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Original_column0&#39;, &#39;Original_column1&#39;, &#39;Original_column2&#39;,
       &#39;Original_column3&#39;, &#39;Original_column4&#39;, &#39;Original_column5&#39;,
       &#39;Original_column6&#39;, &#39;New_column0&#39;, &#39;New_column1&#39;, &#39;New_column2&#39;,
       &#39;New_column3&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
</section>
<section id="re-ordering-columns">
<h3>Re-ordering Columns<a class="headerlink" href="#re-ordering-columns" title="Permalink to this headline">#</a></h3>
<p>By default, new columns are added to the right-hand side of the data frame. But you may have reasons to want the columns to appear in a particular order, or perhaps you’d just find it more convenient to have new columns on the left-hand side when there are many columns in a data frame (which happens a lot).</p>
<p>The simplest way to re-order (all) columns is to create a new list of their names with them in the order that you’d like them: but be careful you don’t forget any columns that you’d like to keep!</p>
<p>Let’s see an example with a fresh version of the fake data from earlier. We’ll put all of the odd-numbered columns first, in descending order, then the even similarly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">36</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)),</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">],</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;col&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)],</span>
    <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col0</th>
      <th>col1</th>
      <th>col2</th>
      <th>col3</th>
      <th>col4</th>
      <th>col5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>6.0</td>
      <td>7.0</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>12.0</td>
      <td>13.0</td>
      <td>14.0</td>
      <td>15.0</td>
      <td>16.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>d</th>
      <td>18.0</td>
      <td>19.0</td>
      <td>20.0</td>
      <td>21.0</td>
      <td>22.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>24.0</td>
      <td>25.0</td>
      <td>26.0</td>
      <td>27.0</td>
      <td>28.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>f</th>
      <td>30.0</td>
      <td>31.0</td>
      <td>32.0</td>
      <td>33.0</td>
      <td>34.0</td>
      <td>35.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;col5&quot;</span><span class="p">,</span> <span class="s2">&quot;col3&quot;</span><span class="p">,</span> <span class="s2">&quot;col1&quot;</span><span class="p">,</span> <span class="s2">&quot;col4&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">,</span> <span class="s2">&quot;col0&quot;</span><span class="p">]]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col5</th>
      <th>col3</th>
      <th>col1</th>
      <th>col4</th>
      <th>col2</th>
      <th>col0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>5.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>11.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>17.0</td>
      <td>15.0</td>
      <td>13.0</td>
      <td>16.0</td>
      <td>14.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>d</th>
      <td>23.0</td>
      <td>21.0</td>
      <td>19.0</td>
      <td>22.0</td>
      <td>20.0</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>29.0</td>
      <td>27.0</td>
      <td>25.0</td>
      <td>28.0</td>
      <td>26.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>f</th>
      <td>35.0</td>
      <td>33.0</td>
      <td>31.0</td>
      <td>34.0</td>
      <td>32.0</td>
      <td>30.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Of course, this is quite tedious if you have lots of columns! There are methods that can help make this easier depending on your context. Perhaps you’d just liked to sort the columns in order? This can be achieved by combining <code class="docutils literal notranslate"><span class="pre">sorted</span></code> and the <code class="docutils literal notranslate"><span class="pre">reindex</span></code> command (which works for rows or columns) with <code class="docutils literal notranslate"><span class="pre">axis=1</span></code>, which means the second axis ie columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col0</th>
      <th>col1</th>
      <th>col2</th>
      <th>col3</th>
      <th>col4</th>
      <th>col5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>6.0</td>
      <td>7.0</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>12.0</td>
      <td>13.0</td>
      <td>14.0</td>
      <td>15.0</td>
      <td>16.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>d</th>
      <td>18.0</td>
      <td>19.0</td>
      <td>20.0</td>
      <td>21.0</td>
      <td>22.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>24.0</td>
      <td>25.0</td>
      <td>26.0</td>
      <td>27.0</td>
      <td>28.0</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>f</th>
      <td>30.0</td>
      <td>31.0</td>
      <td>32.0</td>
      <td>33.0</td>
      <td>34.0</td>
      <td>35.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="review-of-how-to-access-rows-columns-and-values">
<h2>Review of How to Access Rows, Columns, and Values<a class="headerlink" href="#review-of-how-to-access-rows-columns-and-values" title="Permalink to this headline">#</a></h2>
<p>With all of these different ways to access values in data frames, it can get confusing. These are the different ways to get the first column of a dataframe (when that first column is called <code class="docutils literal notranslate"><span class="pre">column</span></code> and the dataframe is <code class="docutils literal notranslate"><span class="pre">df</span></code>):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">df.column</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df[&quot;column&quot;]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df.loc[:,</span> <span class="pre">&quot;column&quot;]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df.iloc[:,</span> <span class="pre">0]</span></code></p></li>
</ul>
<p>Note that <code class="docutils literal notranslate"><span class="pre">:</span></code> means ‘give me everything’! The ways to access rows are similar (here assuming the first row is called <code class="docutils literal notranslate"><span class="pre">row</span></code>):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">df.loc[&quot;row&quot;,</span> <span class="pre">:]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df.iloc[0,</span> <span class="pre">:]</span></code></p></li>
</ul>
<p>And to access the first value (ie the value in first row, first column):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">df.column[0]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df[&quot;column&quot;][0]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df.iloc[0,</span> <span class="pre">0]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df.loc[&quot;row&quot;,</span> <span class="pre">&quot;column&quot;]</span></code></p></li>
</ul>
<p>In the above examples, square brackets are instructions about <em>where</em> to grab bits from the data frame. They are a bit like an address system for values within a dataframe. Square brackets <em>also</em> denote lists though. So if you want to select <em>multiple</em> columns or rows, you might see syntax like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">df.loc[[&quot;row0&quot;,</span> <span class="pre">&quot;row1&quot;],</span> <span class="pre">[&quot;column0&quot;,</span> <span class="pre">&quot;column2&quot;]]</span></code></p>
<p>which picks out two rows and two columns via the lists <code class="docutils literal notranslate"><span class="pre">[&quot;row0&quot;,</span> <span class="pre">&quot;row1&quot;]</span></code> and <code class="docutils literal notranslate"><span class="pre">[&quot;column0&quot;,</span> <span class="pre">&quot;column2&quot;]</span></code>. Because there are lists alongside the usual system of selecting values, there are two sets of square brackets.</p>
<div class="tip admonition">
<p class="admonition-title">Tip</p>
<p>If you only want to remember one syntax for accessing rows and columns by name, use the pattern <code class="docutils literal notranslate"><span class="pre">df.loc[[&quot;row0&quot;,</span> <span class="pre">&quot;row1&quot;,</span> <span class="pre">...],</span> <span class="pre">[&quot;col0&quot;,</span> <span class="pre">&quot;col1&quot;,</span> <span class="pre">...]]</span></code>. This also works with a single row or a single column (or both).</p>
<p>If you only want to remember one syntax for accessing rows and columns by position, use the pattern <code class="docutils literal notranslate"><span class="pre">df.iloc[[0,</span> <span class="pre">1,</span> <span class="pre">...],</span> <span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">...]]</span></code>. This also works with a single row or a single column (or both).</p>
</div>
<section id="slicing">
<h3>Slicing<a class="headerlink" href="#slicing" title="Permalink to this headline">#</a></h3>
<p>So often, what we really want is a subset of values (as opposed to <em>all</em> values or just <em>one</em> value). This is where <em>slicing</em> comes in. If you’ve looked at the Chapter on <a class="reference internal" href="code-basics.html#code-basics"><span class="std std-ref">Coding Basics</span></a>, you’ll know a bit about slicing and indexing already, but we’ll cover the basics here too.</p>
<p>The syntax for slicing is similar to what we’ve seen already: there are two methods <code class="docutils literal notranslate"><span class="pre">.loc</span></code> to access items by name, and <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> to access them by position. The syntax for the former is <code class="docutils literal notranslate"><span class="pre">df.loc[start:stop:step,</span> <span class="pre">start:stop:step]</span></code>, where the first position is index name and the second is column name (and the same applies for numbers and <code class="docutils literal notranslate"><span class="pre">df.iloc</span></code>). Let’s see some examples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">:</span><span class="s2">&quot;f&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;col1&quot;</span><span class="p">:</span><span class="s2">&quot;col3&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
    </tr>
    <tr>
      <th>c</th>
    </tr>
    <tr>
      <th>e</th>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As you can see, slicing even works on names! By asking for rows <code class="docutils literal notranslate"><span class="pre">'a':'f':2</span></code>, we get every other row from ‘a’ to ‘f’ (inclusive). Likewise, for columns, we asked for every column between <code class="docutils literal notranslate"><span class="pre">col1</span></code> and <code class="docutils literal notranslate"><span class="pre">col3</span></code> (inclusive). <code class="docutils literal notranslate"><span class="pre">iloc</span></code> works in a very similar way.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col5</th>
      <th>col3</th>
      <th>col1</th>
      <th>col4</th>
      <th>col2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>b</th>
      <td>11.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>10.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>c</th>
      <td>17.0</td>
      <td>15.0</td>
      <td>13.0</td>
      <td>16.0</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>d</th>
      <td>23.0</td>
      <td>21.0</td>
      <td>19.0</td>
      <td>22.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>29.0</td>
      <td>27.0</td>
      <td>25.0</td>
      <td>28.0</td>
      <td>26.0</td>
    </tr>
    <tr>
      <th>f</th>
      <td>35.0</td>
      <td>33.0</td>
      <td>31.0</td>
      <td>34.0</td>
      <td>32.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In this case, we asked for everything from row 1 onwards, and everything up to (but excluding) the last column.</p>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Access every other column between columns 1 and 5, and rows a to c using the <code class="docutils literal notranslate"><span class="pre">.loc</span></code> syntax.</p>
<p>Access the same columns and rows using the <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> syntax.</p>
</div>
<p>It’s not just strings and positions that can be sliced though, here’s an example using <em>dates</em> (<strong>pandas</strong> support for dates is truly excellent):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;1/1/2000&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;Q&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s2">&quot;ABCDE&quot;</span><span class="p">))</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-03-31</th>
      <td>3</td>
      <td>8</td>
      <td>6</td>
      <td>0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2000-06-30</th>
      <td>9</td>
      <td>9</td>
      <td>2</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2000-09-30</th>
      <td>4</td>
      <td>4</td>
      <td>7</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2000-12-31</th>
      <td>2</td>
      <td>8</td>
      <td>7</td>
      <td>6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2001-03-31</th>
      <td>8</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2001-06-30</th>
      <td>8</td>
      <td>2</td>
      <td>7</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2001-09-30</th>
      <td>8</td>
      <td>4</td>
      <td>4</td>
      <td>6</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2001-12-31</th>
      <td>4</td>
      <td>7</td>
      <td>9</td>
      <td>1</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2002-03-31</th>
      <td>7</td>
      <td>5</td>
      <td>9</td>
      <td>9</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2002-06-30</th>
      <td>0</td>
      <td>4</td>
      <td>2</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2002-09-30</th>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2002-12-31</th>
      <td>3</td>
      <td>2</td>
      <td>5</td>
      <td>2</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now let’s do some slicing!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;2000-01-01&quot;</span><span class="p">:</span><span class="s2">&quot;2002-01-01&quot;</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-03-31</th>
      <td>3</td>
      <td>8</td>
      <td>6</td>
      <td>0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2000-06-30</th>
      <td>9</td>
      <td>9</td>
      <td>2</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2000-09-30</th>
      <td>4</td>
      <td>4</td>
      <td>7</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2000-12-31</th>
      <td>2</td>
      <td>8</td>
      <td>7</td>
      <td>6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2001-03-31</th>
      <td>8</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2001-06-30</th>
      <td>8</td>
      <td>2</td>
      <td>7</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2001-09-30</th>
      <td>8</td>
      <td>4</td>
      <td>4</td>
      <td>6</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2001-12-31</th>
      <td>4</td>
      <td>7</td>
      <td>9</td>
      <td>1</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Two important points to note here: first, <strong>pandas</strong> doesn’t mind that we supplied a date that didn’t actually exist in the index. It worked out that by ‘2000-01-01’ we meant a datetime and compared the values of the index to that datetime in order to decide what rows to return from the dataframe. The second thing to notice is the use of <code class="docutils literal notranslate"><span class="pre">:</span></code> for the column names; this explicitly says ‘give me all the columns’.</p>
</section>
</section>
<section id="operations-on-rows-columns-and-dataframes">
<h2>Operations on Rows, Columns, and DataFrames<a class="headerlink" href="#operations-on-rows-columns-and-dataframes" title="Permalink to this headline">#</a></h2>
<section id="operations-that-can-apply-to-both-rows-and-columns">
<h3>Operations that can <code class="docutils literal notranslate"><span class="pre">apply</span></code> to both rows and columns<a class="headerlink" href="#operations-that-can-apply-to-both-rows-and-columns" title="Permalink to this headline">#</a></h3>
<p>One of <strong>pandas</strong> features is that it is happy for you to do operations on either <em>rows</em> or <em>columns</em> by changing a single keyword argument via the <code class="docutils literal notranslate"><span class="pre">apply</span></code> method. Both regular functions and lambda functions can be used with the more general apply method, which takes a function and applies it to a given axis (<code class="docutils literal notranslate"><span class="pre">axis=0</span></code> or <code class="docutils literal notranslate"><span class="pre">axis=&quot;rows&quot;</span></code> for rows, <code class="docutils literal notranslate"><span class="pre">axis=1</span></code> or <code class="docutils literal notranslate"><span class="pre">axis=&quot;columns&quot;</span></code> for columns). Let’s generate some data to demonstrate this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s2">&quot;ABCDE&quot;</span><span class="p">))</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;A_times_B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>A_times_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Of course, the much easier way to do this very common operation is <code class="docutils literal notranslate"><span class="pre">df['val1_times_val2']</span> <span class="pre">=</span> <span class="pre">df['values1']*df['values2']</span></code>, but there are times when you need to run more complex functions element-wise and, for those, <code class="docutils literal notranslate"><span class="pre">apply</span></code> is really useful.</p>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Write an apply function that raises entries in <code class="docutils literal notranslate"><span class="pre">B</span></code> to the power of entries in <code class="docutils literal notranslate"><span class="pre">D</span></code>.</p>
</div>
<p>Apply doesn’t just do this with lambda functions, it also works with custom functions. Below is a contrived example (which, in practice, you would do with <code class="docutils literal notranslate"><span class="pre">df[&quot;E&quot;]</span> <span class="pre">-</span> <span class="pre">4</span></code>). Note that we are specifying that the apply should be on a particular column by saying <code class="docutils literal notranslate"><span class="pre">df[&quot;E&quot;]</span></code> on the right-hand side, but we could have alternatively done <code class="docutils literal notranslate"><span class="pre">df.apply(lambda</span> <span class="pre">x:</span> <span class="pre">x[&quot;E&quot;],</span> <span class="pre">axis=1)</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">subtract_four</span><span class="p">(</span><span class="n">input_number</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">input_number</span> <span class="o">-</span> <span class="mi">4</span>


<span class="n">df</span><span class="p">[</span><span class="s2">&quot;sub_four_col&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">subtract_four</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
      <th>A_times_B</th>
      <th>sub_four_col</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>-4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="operations-on-dataframes">
<h3>Operations on DataFrames<a class="headerlink" href="#operations-on-dataframes" title="Permalink to this headline">#</a></h3>
<p>Operations on whole dataframes are also supported, but if you’re doing very heavy lifting you might want to just switch to using numpy arrays (<strong>numpy</strong> provides fast numerical, vector, matrix, and tensor operations in Python; it has some similarities with the functionality of Matlab). As examples though, you can transpose and exponentiate easily:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s2">&quot;ABCDE&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Dataframe:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Exponentiation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Transpose:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Dataframe:
   A  B  C  D  E
0  4  2  4  3  1
1  0  3  1  3  2
2  1  0  3  3  2

 Exponentiation:
           A          B          C          D         E
0  54.598150   7.389056  54.598150  20.085537  2.718282
1   1.000000  20.085537   2.718282  20.085537  7.389056
2   2.718282   1.000000  20.085537  20.085537  7.389056

 Transpose:
   0  1  2
A  4  0  1
B  2  3  0
C  4  1  3
D  3  3  3
E  1  2  2
</pre></div>
</div>
</div>
</div>
</section>
<section id="column-and-row-exercises">
<h3>Column and Row Exercises<a class="headerlink" href="#column-and-row-exercises" title="Permalink to this headline">#</a></h3>
<ol>
<li><p>Compare <code class="docutils literal notranslate"><span class="pre">air_time</span></code> with <code class="docutils literal notranslate"><span class="pre">arr_time</span> <span class="pre">-</span> <span class="pre">dep_time</span></code>. What do you expect to see? What do you see What do you need to do to fix it?</p></li>
<li><p>Compare <code class="docutils literal notranslate"><span class="pre">dep_time</span></code>, <code class="docutils literal notranslate"><span class="pre">sched_dep_time</span></code>, and <code class="docutils literal notranslate"><span class="pre">dep_delay</span></code>. How would you expect those three numbers to be related?</p></li>
<li><p>Brainstorm as many ways as possible to select <code class="docutils literal notranslate"><span class="pre">dep_time</span></code>, <code class="docutils literal notranslate"><span class="pre">dep_delay</span></code>, <code class="docutils literal notranslate"><span class="pre">arr_time</span></code>, and <code class="docutils literal notranslate"><span class="pre">arr_delay</span></code> from <code class="docutils literal notranslate"><span class="pre">flights</span></code>.</p></li>
<li><p>What happens if you include the name of a row or column multiple times when trying to select them?</p></li>
<li><p>What does the <code class="docutils literal notranslate"><span class="pre">.isin</span></code> function do in the following?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">flights</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;day&quot;</span><span class="p">,</span> <span class="s2">&quot;dep_delay&quot;</span><span class="p">,</span> <span class="s2">&quot;arr_delay&quot;</span><span class="p">])</span>
</pre></div>
</div>
</li>
<li><p>Does the result of running the following code surprise you?
How do functions like <code class="docutils literal notranslate"><span class="pre">str.contains</span></code> deal with case by default?
How can you change that default?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">flights</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">flights</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;TIME&quot;</span><span class="p">)]</span>
</pre></div>
</div>
<p>(Hint: you can use help even on functions that apply to data frames, eg use <code class="docutils literal notranslate"><span class="pre">help(flights.columns.str.contains)</span></code>)</p>
</li>
</ol>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="data-analysis-quickstart.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Data Analysis Quickstart</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="data-transformation.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Data Transformation</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Arthur Turrell<br/>
  
      &copy; Copyright 2022.<br/>
    <div class="extra_footer">
      This book is available under an MIT license.
    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>